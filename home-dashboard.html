<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="dashboard.page_title">La Tanda - Web3 DeFi Ecosystem</title>
    <meta name="description" content="Dashboard principal La Tanda Web3 Ecosystem">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Web3 Crypto Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;800;900&family=Rajdhani:wght@300;400;500;600;700&family=Space+Mono:wght@400;700&family=Exo+2:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* ================================
           üåê WEB3 DESIGN SYSTEM
           ================================ */

        /* Enhanced animated background with glassmorphism effects */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 25% 25%, rgba(0, 255, 255, 0.1) 0%, transparent 70%),
                radial-gradient(circle at 75% 75%, rgba(127, 255, 216, 0.05) 0%, transparent 70%);
            animation: backgroundPulse 8s ease-in-out infinite alternate;
            z-index: -1;
        }
        
        /* Additional floating background elements */
        body::after {
            content: '';
            position: fixed;
            top: 10%;
            right: 10%;
            width: 200px;
            height: 200px;
            background: radial-gradient(circle, rgba(0, 255, 255, 0.03) 0%, transparent 70%);
            border-radius: 50%;
            animation: float 6s ease-in-out infinite;
            z-index: -1;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(5deg); }
        }
        
        @keyframes backgroundPulse {
            0% { opacity: 0.3; }
            100% { opacity: 0.7; }
        }

        /* ================================
           üçî SIDEBAR NAVIGATION
           ================================ */
        .sidebar {
            position: fixed;
            top: 0;
            left: -320px;
            width: 320px;
            height: 100vh;
            background: var(--bg-card);
            backdrop-filter: blur(24px);
            border-right: 2px solid var(--border-accent);
            z-index: 1000;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            overflow-y: auto;
            box-shadow: 0 0 50px rgba(0, 0, 0, 0.5);
        }

        .sidebar.active {
            left: 0;
        }

        .sidebar-header {
            padding: 24px;
            border-bottom: 1px solid var(--border-card);
            text-align: center;
        }

        .sidebar-logo {
            width: 60px;
            height: 60px;
            background: white;
            border-radius: 15px;
            margin: 0 auto 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
        }

        .sidebar-logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .sidebar-title {
            font-family: 'Orbitron', monospace;
            font-size: 20px;
            font-weight: 800;
            background: linear-gradient(135deg, var(--tanda-cyan), var(--crypto-gold));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
        }

        .sidebar-subtitle {
            font-size: 12px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .nav-section {
            padding: 16px 0;
        }

        .nav-section-title {
            padding: 8px 24px;
            font-size: 11px;
            font-weight: 700;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1.5px;
            border-bottom: 1px solid var(--border-card);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            padding: 12px 24px;
            color: var(--text-secondary);
            text-decoration: none;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .nav-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 4px;
            background: var(--tanda-cyan);
            transform: scaleY(0);
            transition: transform 0.3s ease;
        }

        .nav-item:hover::before {
            transform: scaleY(1);
        }

        .nav-item:hover {
            background: rgba(0, 255, 255, 0.05);
            color: var(--tanda-cyan);
            transform: translateX(8px);
            border-left: 2px solid var(--tanda-cyan);
            box-shadow: 0 4px 20px rgba(0, 255, 255, 0.15);
        }

        .nav-item.active {
            background: rgba(0, 255, 255, 0.1);
            color: var(--tanda-cyan);
            border-left: 4px solid var(--tanda-cyan);
        }

        .nav-icon {
            width: 20px;
            height: 20px;
            margin-right: 12px;
            font-size: 16px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .nav-item:hover .nav-icon {
            transform: scale(1.1);
            text-shadow: 0 0 10px var(--tanda-cyan);
        }

        .nav-text {
            font-size: 14px;
            font-weight: 500;
            flex: 1;
        }

        .nav-badge {
            background: linear-gradient(135deg, var(--tanda-cyan), var(--crypto-gold));
            color: var(--tanda-black);
            font-size: 10px;
            font-weight: 700;
            padding: 2px 6px;
            border-radius: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            box-shadow: 0 2px 8px rgba(0, 255, 255, 0.3);
        }

        .nav-badge.hot {
            background: linear-gradient(135deg, #ff6b6b, #ff8e53);
            animation: pulse 2s ease-in-out infinite;
        }

        .nav-badge.new {
            background: linear-gradient(135deg, #22d55e, #16a34a);
        }

        .nav-badge.beta {
            background: linear-gradient(135deg, #8b5cf6, #a855f7);
        }

        .nav-badge.pro {
            background: linear-gradient(135deg, var(--crypto-gold), #e6c200);
        }

        .nav-badge.alert {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            animation: pulse 1.5s ease-in-out infinite;
        }

        .sidebar-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(4px);
            z-index: 999;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .sidebar-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        :root {
            /* La Tanda Web3 Colors */
            --tanda-cyan: #00FFFF;
            --tanda-cyan-light: #7FFFD8;
            --tanda-cyan-dark: #00E5E5;
            --tanda-black: #000000;
            --text-primary: #f8fafc;
            --text-secondary: rgba(248, 250, 252, 0.7);
            --text-accent: #00FFFF;
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-card: rgba(15, 23, 42, 0.6);
            --border-card: rgba(0, 255, 255, 0.1);
            --border-accent: rgba(0, 255, 255, 0.2);
            --crypto-gold: #ffd700;
            --success-color: #22d55e;
            --warning-color: #fbbf24;
            --error-color: #f87171;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Rajdhani', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-primary);
            min-height: 100vh;
            color: var(--text-primary);
            overflow-x: hidden;
            position: relative;
        }
        
        /* ================================
           ‚ú® BACKGROUND EFFECTS
           ================================ */
        .bg-effects {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }

        .gradient-orb {
            position: absolute;
            border-radius: 50%;
            filter: blur(40px);
            opacity: 0.7;
            animation: float 6s ease-in-out infinite;
        }

        .gradient-orb-1 {
            width: 300px;
            height: 300px;
            background: radial-gradient(circle, var(--tanda-cyan) 0%, transparent 70%);
            top: 10%;
            left: 15%;
            animation-delay: 0s;
        }

        .gradient-orb-2 {
            width: 250px;
            height: 250px;
            background: radial-gradient(circle, var(--crypto-gold) 0%, transparent 70%);
            top: 60%;
            right: 20%;
            animation-delay: 2s;
        }

        .gradient-orb-3 {
            width: 200px;
            height: 200px;
            background: radial-gradient(circle, #8b5cf6 0%, transparent 70%);
            bottom: 20%;
            left: 70%;
            animation-delay: 4s;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) scale(1); }
            33% { transform: translateY(-30px) scale(1.1); }
            66% { transform: translateY(15px) scale(0.9); }
        }

        /* ================================
           üì¶ CONTAINER
           ================================ */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 90px 20px 0 20px; /* top=header space */
            position: relative;
            z-index: 1;
        }

        /* ================================
           üè¢ MODERN HEADER WITH MENU
           ================================ */
        .page-header {
            background: var(--bg-card);
            backdrop-filter: blur(24px);
            border: 2px solid var(--border-accent);
            border-radius: 20px;
            padding: 20px 30px;
            margin: 20px 0 30px 0;
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.3), 
                0 0 40px rgba(0, 255, 255, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
        }

        .hamburger-menu {
            background: rgba(0, 255, 255, 0.1);
            border: 1px solid var(--border-accent);
            color: var(--tanda-cyan);
            width: 50px;
            height: 50px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            position: relative;
            backdrop-filter: blur(10px);
        }

        .hamburger-menu:hover {
            background: var(--tanda-cyan);
            color: var(--tanda-black);
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(0, 255, 255, 0.4);
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-img {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
            overflow: hidden;
        }

        .logo-img img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .page-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent 30%, rgba(0, 255, 255, 0.03) 50%, transparent 70%);
            pointer-events: none;
        }

        .header-top-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .header-left-section {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .header-title h1 {
            font-family: 'Orbitron', monospace;
            font-size: 32px;
            font-weight: 800;
            background: linear-gradient(135deg, var(--tanda-cyan), var(--tanda-cyan-light), var(--crypto-gold));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 0 30px rgba(0, 255, 255, 0.3);
            margin: 0;
        }

        /* ================================
           üìã MAIN STATS CAROUSEL SECTION
           ================================ */
        .stats-carousel-container {
            position: relative;
            margin-bottom: 32px;
            overflow: hidden;
            border-radius: 16px;
        }

        .stats-carousel {
            display: flex;
            transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .stats-slide {
            min-width: 100%;
            display: flex;
            flex-direction: column;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .carousel-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 16px;
            margin-top: 20px;
        }

        .carousel-btn {
            background: rgba(0, 255, 255, 0.1);
            border: 1px solid var(--border-accent);
            color: var(--tanda-cyan);
            width: 40px;
            height: 40px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        .carousel-btn:hover {
            background: var(--tanda-cyan);
            color: var(--tanda-black);
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(0, 255, 255, 0.4);
        }

        .carousel-indicators {
            display: flex;
            gap: 8px;
        }

        .carousel-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(0, 255, 255, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .carousel-dot.active {
            background: var(--tanda-cyan);
            box-shadow: 0 0 15px rgba(0, 255, 255, 0.5);
        }

        .slide-title {
            text-align: center;
            font-family: 'Orbitron', monospace;
            font-size: 20px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--tanda-cyan), var(--tanda-cyan-light), var(--crypto-gold));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
            margin-bottom: 24px;
            text-transform: uppercase;
            letter-spacing: 2px;
            position: relative;
            padding: 16px 0;
        }

        .slide-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 120px;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--tanda-cyan), transparent);
            box-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
        }

        .stat-card {
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border-card);
            border-radius: 16px;
            padding: 24px;
            position: relative;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .stat-card:hover {
            transform: translateY(-4px);
            border-color: var(--border-accent);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .stat-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            background: linear-gradient(135deg, var(--tanda-cyan), var(--tanda-cyan-light));
            color: var(--tanda-black);
            box-shadow: 0 0 15px rgba(0, 255, 255, 0.3);
        }

        .stat-trend {
            font-size: 12px;
            font-weight: 600;
            padding: 4px 8px;
            border-radius: 6px;
        }

        .trend-positive {
            background: rgba(34, 213, 94, 0.2);
            color: var(--success-color);
        }

        .stat-label {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .stat-value {
            font-size: 28px;
            font-weight: 800;
            background: linear-gradient(135deg, var(--tanda-cyan), var(--crypto-gold));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
        }

        .stat-subtitle {
            font-size: 12px;
            color: var(--text-secondary);
        }

        /* ================================
           üìä QUICK ACTIONS SECTION
           ================================ */
        .quick-actions {
            margin-bottom: 32px;
        }

        .section-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .actions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
        }

        .action-item {
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border-card);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            color: inherit;
        }

        .action-item:hover {
            transform: translateY(-4px);
            border-color: var(--border-accent);
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.3);
        }

        .action-icon {
            font-size: 32px;
            color: var(--tanda-cyan);
            margin-bottom: 12px;
        }

        .action-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .action-description {
            font-size: 12px;
            color: var(--text-secondary);
        }

        /* ================================
           üìà RECENT ACTIVITY SECTION
           ================================ */
        .recent-activity {
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border-card);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 32px;
        }

        .activity-item {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 16px 0;
            border-bottom: 1px solid var(--border-card);
        }

        .activity-item:last-child {
            border-bottom: none;
        }

        .activity-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            background: linear-gradient(135deg, var(--tanda-cyan), var(--tanda-cyan-light));
            color: var(--tanda-black);
        }

        .activity-content {
            flex: 1;
        }

        .activity-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .activity-time {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .activity-amount {
            font-size: 16px;
            font-weight: 700;
            color: var(--tanda-cyan);
        }

        .header-subtitle {
            font-family: 'Rajdhani', sans-serif;
            font-size: 16px;
            color: var(--text-secondary);
            font-weight: 500;
            margin: 8px 0 0 0;
            opacity: 0.9;
        }

        .header-right-section {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .header-quick-actions {
            display: flex;
            gap: 12px;
        }

        .header-action-btn {
            background: rgba(0, 255, 255, 0.1);
            border: 1px solid var(--border-accent);
            color: var(--tanda-cyan);
            width: 45px;
            height: 45px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            position: relative;
            backdrop-filter: blur(10px);
        }

        .header-action-btn:hover {
            background: var(--tanda-cyan);
            color: var(--tanda-black);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 255, 255, 0.4);
            border-color: var(--tanda-cyan);
        }

        .notification-dot {
            position: absolute;
            top: -5px;
            right: -5px;
            background: linear-gradient(135deg, #ff6b6b, #ff8e53);
            color: white;
            font-size: 10px;
            font-weight: 700;
            padding: 2px 6px;
            border-radius: 10px;
            min-width: 18px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(255, 107, 107, 0.4);
        }

        .network-status-modern {
            display: flex;
            align-items: center;
            gap: 12px;
            background: rgba(34, 213, 94, 0.1);
            border: 1px solid var(--success-color);
            border-radius: 25px;
            padding: 8px 16px;
            font-size: 14px;
            font-weight: 600;
            color: var(--success-color);
        }

        .network-status-modern .status-dot {
            width: 8px;
            height: 8px;
            background: var(--success-color);
            border-radius: 50%;
            animation: pulse 2s ease-in-out infinite;
            box-shadow: 0 0 10px var(--success-color);
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* ================================
           üöÄ FUTURISTIC WEB3 HEADER ELEMENTS
           ================================ */
        .crypto-ticker {
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(6px);
            border-bottom: 1px solid rgba(0, 255, 255, 0.08);
            padding: 2px 0;
            overflow: hidden;
            position: relative;
            margin-bottom: 8px;
            margin-top: 1px;
        }

        .ticker-content {
            display: flex;
            animation: scroll 45s linear infinite;
            gap: 32px;
            white-space: nowrap;
            padding: 0 12px;
        }

        .ticker-item {
            display: flex;
            align-items: center;
            gap: 3px;
            font-size: 10px;
            font-weight: 300;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            letter-spacing: 0.2px;
        }

        .ticker-item:hover {
            color: var(--tanda-cyan);
            transform: scale(1.01);
        }

        .ticker-symbol {
            font-family: 'Inter', monospace;
            font-weight: 500;
            font-size: 9px;
            text-transform: uppercase;
            letter-spacing: 0.4px;
            opacity: 0.85;
        }

        .ticker-price {
            color: var(--tanda-cyan);
            font-weight: 400;
            font-size: 10px;
            font-family: 'Inter', monospace;
        }

        .ticker-change {
            padding: 1px 4px;
            border-radius: 3px;
            font-size: 9px;
            font-weight: 400;
            font-family: 'Inter', monospace;
            letter-spacing: 0.1px;
        }

        .ticker-event {
            color: var(--crypto-gold);
            font-weight: 400;
            font-size: 10px;
            font-family: 'Inter', sans-serif;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .ticker-event-icon {
            font-size: 8px;
            opacity: 0.8;
        }

        .ticker-news {
            color: var(--text-secondary);
            font-weight: 300;
            font-size: 10px;
            font-family: 'Inter', sans-serif;
        }

        .ticker-positive {
            background: rgba(34, 213, 94, 0.2);
            color: var(--success-color);
        }

        .ticker-negative {
            background: rgba(248, 113, 113, 0.2);
            color: var(--error-color);
        }

        @keyframes scroll {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }

        .blockchain-status {
            display: flex;
            align-items: center;
            gap: 16px;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-card);
            border-radius: 20px;
            padding: 8px 16px;
            font-size: 12px;
            color: var(--text-secondary);
        }

        .chain-indicator {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .chain-dot {
            width: 8px;
            height: 8px;
            background: var(--success-color);
            border-radius: 50%;
            animation: pulse 2s ease-in-out infinite;
        }

        .wallet-connect {
            display: inline-flex;
            max-height: 36px;
            max-width: 130px;
            align-items: center;
            gap: 2px;
            background: linear-gradient(135deg, rgba(0, 255, 255, 0.1), rgba(255, 215, 0, 0.1));
            border: 1px solid var(--border-accent);
            border-radius: 8px;
            padding: 2px 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .wallet-connect:hover {
            background: linear-gradient(135deg, rgba(0, 255, 255, 0.2), rgba(255, 215, 0, 0.2));
            // transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 255, 255, 0.3);
        }

.wallet-info { display: flex; flex-direction: column; justify-content: center; width: 100%; overflow: hidden; min-width: 0; }
        .wallet-address {
            font-family: 'Space Mono', monospace;
            font-size: 9px;
            color: var(--text-secondary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

.wallet-toggle-visibility {            background: transparent;            border: none;            color: var(--text-secondary);            cursor: pointer;            padding: 0 2px;            margin-left: 4px;            font-size: 9px;            transition: color 0.2s;            display: flex;            align-items: center;        }        .wallet-toggle-visibility:hover {            color: var(--tanda-cyan);        }        .wallet-balance.hidden {            display: none;        }
        .wallet-balance {
            font-weight: 700;
            color: var(--tanda-cyan);
            font-size: 9px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .tx-progress {
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-card);
            border-radius: 12px;
            padding: 8px 12px;
            font-size: 9px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tx-counter {
        /* Network Switcher Styles - Component 3 */
        .network-switcher {
            position: relative;
            display: inline-flex;
            align-items: center;
            max-height: 36px;
            background: linear-gradient(135deg, rgba(138, 43, 226, 0.1), rgba(75, 0, 130, 0.1));
            border: 1px solid rgba(138, 43, 226, 0.3);
            border-radius: 8px;
            padding: 4px 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            gap: 6px;
        }

        .network-switcher:hover {
            background: linear-gradient(135deg, rgba(138, 43, 226, 0.2), rgba(75, 0, 130, 0.2));
            box-shadow: 0 8px 25px rgba(138, 43, 226, 0.3);
        }

        .network-icon {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: bold;
        }

        .network-info {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .network-name {
            font-size: 10px;
            font-weight: 600;
            color: var(--text-primary);
            white-space: nowrap;
        }

        .network-status {
            font-size: 8px;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .status-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: #00ff00;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .network-dropdown {
            position: absolute !important;
            top: calc(100% + 8px);
            right: 0;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(24px);
            border: 1px solid rgba(148, 163, 184, 0.2);
            border-radius: 12px;
            padding: 8px;
            min-width: 200px;
            display: none;
            z-index: 1000;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .network-dropdown.active {
            display: block;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .network-option {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .network-option:hover {
            background: rgba(0, 255, 255, 0.1);
        }

        .network-option.active {
            background: rgba(0, 255, 255, 0.15);
            border: 1px solid rgba(0, 255, 255, 0.3);
        }

        .network-option-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }

        .network-option-info {
            flex: 1;
        }

        .network-option-name {
            font-size: 11px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .network-option-chain {
            font-size: 9px;
            color: var(--text-secondary);
        }

        .network-dropdown-header {
            padding: 8px 12px;
            border-bottom: 1px solid rgba(148, 163, 184, 0.1);
            margin-bottom: 8px;
        }

        .network-dropdown-title {
            font-size: 11px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
            color: var(--warning-color);
            font-weight: 600;
        }

        .tx-progress-bar {
            width: 60px;
            height: 4px;
            background: rgba(251, 191, 36, 0.2);
            border-radius: 2px;
            overflow: hidden;
        }

        .tx-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--warning-color), var(--success-color));
            border-radius: 2px;
            animation: progressPulse 2s ease-in-out infinite;
        }

        @keyframes progressPulse {
            0%, 100% { width: 30%; }
            50% { width: 80%; }
        }

        .preferences-toggle {
            background: rgba(0, 0, 0, 0.6);
            border: 1px solid var(--border-card);
            border-radius: 12px;
            padding: 8px 12px;
            display: flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--text-secondary);
            position: relative;
        }

        .preferences-toggle:hover {
            border-color: var(--tanda-cyan);
            color: var(--tanda-cyan);
            box-shadow: 0 0 10px rgba(0, 255, 255, 0.2);
        }

        .toggle-arrow {
            font-size: 10px;
            transition: transform 0.3s ease;
        }

        .preferences-toggle.active .toggle-arrow {
            transform: rotate(180deg);
        }

        .preferences-dropdown {
            position: fixed;
            top: 80px;
            right: 20px;
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border-accent);
            border-radius: 12px;
            padding: 16px;
            min-width: 220px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            z-index: 2000;
            animation: fadeIn 0.3s ease;
        }

        .preference-group {
            margin-bottom: 12px;
        }

        .preference-group:last-child {
            margin-bottom: 0;
        }

        .preference-group label {
            display: block;
            color: var(--text-secondary);
            font-size: 12px;
            font-weight: 500;
            margin-bottom: 6px;
        }

        .theme-toggle, .language-toggle, .currency-toggle {
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid var(--border-card);
            border-radius: 16px;
            padding: 3px;
            display: flex;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .theme-toggle:hover, .language-toggle:hover, .currency-toggle:hover {
            border-color: var(--tanda-cyan);
            box-shadow: 0 0 8px rgba(0, 255, 255, 0.2);
        }

        .theme-option, .lang-option, .currency-option {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            transition: all 0.3s ease;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 2px;
        }

        .theme-option.active, .lang-option.active, .currency-option.active {
            background: linear-gradient(135deg, var(--tanda-cyan), var(--tanda-cyan-light));
            color: var(--tanda-black);
            box-shadow: 0 2px 8px rgba(0, 255, 255, 0.3);
        }

        .security-alerts {
            display: flex;
            align-items: center;
            gap: 8px;
            background: linear-gradient(135deg, rgba(34, 213, 94, 0.1), rgba(22, 163, 74, 0.1));
            border: 1px solid var(--success-color);
            border-radius: 12px;
            padding: 6px 12px;
            font-size: 12px;
            color: var(--success-color);
        }

        .alert-icon {
            font-size: 14px;
        }

        .header-center-section {
            display: flex;
            align-items: center;
            gap: 16px;
            flex: 1;
            justify-content: center;
        }

        .header-advanced-controls {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        /* ================================
           üí´ FLASH CARDS STYLES
           ================================ */
        .flash-cards-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 20px;
            margin-bottom: 32px;
            position: relative;
            z-index: 1;
        }

        .flash-card {
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border-card);
            border-radius: 16px;
            padding: 24px;
            position: relative;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            transform-style: preserve-3d;
            perspective: 1000px;
            animation: slideIn 0.6s ease-out;
        }

        .flash-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.02) 50%, transparent 70%);
            transform: translateX(-100%);
            transition: transform 0.6s ease;
            pointer-events: none;
        }

        .flash-card:hover::before {
            transform: translateX(100%);
        }

        .flash-card:hover {
            transform: translateY(-8px) rotateX(2deg);
            border-color: var(--border-accent);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4), 0 0 30px rgba(0, 255, 255, 0.2);
        }

        .card-glow {
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, var(--tanda-cyan), transparent, var(--crypto-gold), transparent, var(--tanda-cyan));
            border-radius: 18px;
            opacity: 0;
            transition: opacity 0.4s ease;
            z-index: -1;
            animation: glowRotate 3s linear infinite;
        }

        .flash-card:hover .card-glow {
            opacity: 0.6;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .card-icon {
            font-size: 24px;
            color: var(--tanda-cyan);
            text-shadow: 0 0 15px var(--tanda-cyan);
        }

        .card-badge {
            background: linear-gradient(135deg, var(--tanda-cyan), var(--tanda-cyan-light));
            color: var(--tanda-black);
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 4px 15px rgba(0, 255, 255, 0.3);
        }

        .card-content {
            margin-bottom: 16px;
        }

        .card-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 8px;
            line-height: 1.3;
        }

        .card-description {
            font-size: 14px;
            color: var(--text-secondary);
            line-height: 1.5;
            margin-bottom: 12px;
        }

        .card-value {
            font-size: 24px;
            font-weight: 800;
            background: linear-gradient(135deg, var(--tanda-cyan), var(--crypto-gold));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
        }

        .card-action {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 16px;
            border-top: 1px solid var(--border-card);
        }

        .action-btn {
            background: rgba(0, 255, 255, 0.1);
            border: 1px solid var(--tanda-cyan);
            color: var(--tanda-cyan);
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .action-btn:hover {
            background: var(--tanda-cyan);
            color: var(--tanda-black);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 255, 255, 0.3);
        }

        .card-trend {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 12px;
            font-weight: 600;
        }

        .trend-up {
            color: var(--success-color);
        }

        .trend-down {
            color: var(--error-color);
        }

        /* ================================
           üé¨ ANIMATIONS
           ================================ */
        @keyframes slideIn {
            from { 
                opacity: 0; 
                transform: translateY(30px); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0); 
            }
        }

        @keyframes glowRotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes slideOutRight {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }

        /* ================================
           üì± RESPONSIVE DESIGN - ENHANCED
           ================================ */
        
        /* Large tablets and small desktops */
        @media (max-width: 1024px) {
            .flash-cards-container {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        /* Tablets */
        @media (max-width: 768px) {
            .container {
                padding: 0 16px;
            }
            
            .sidebar {
                width: 280px;
                left: -280px;
            }
            
            .crypto-ticker {
                padding: 8px 16px;
            }
            
            .ticker-content {
                animation-duration: 40s; /* Slower on mobile for readability */
            }
            
            .page-header {
                padding: 16px 20px;
                margin: 16px 0 24px 0;
            }

            .header-top-row {
                flex-direction: column;
                gap: 16px;
                text-align: center;
            }

            .header-title h1 {
                font-size: 24px;
            }

            .flash-cards-container {
                grid-template-columns: 1fr;
                gap: 16px;
            }

            .header-quick-actions {
                justify-content: center;
                flex-wrap: wrap;
            }
            
            .header-action-btn {
                min-width: 44px; /* Touch-friendly size */
                min-height: 44px;
            }
            
            .stats-slide {
                padding: 16px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }
            
            .stat-card {
                padding: 16px;
            }
            
            .modal-content {
                width: 95vw;
                max-width: none;
                margin: 20px;
                max-height: 90vh;
                overflow-y: auto;
            }
            }
        }

    
        /* ============================================
           DASHBOARD SECTIONS - LA TANDA STYLE
           ============================================ */
        
        .dashboard-sections {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 24px;
        }
        
        .dashboard-section {
            background: var(--lt-bg-card, #161b22);
            border: 1px solid var(--lt-border-accent, rgba(0, 212, 255, 0.2));
            border-radius: var(--lt-radius-lg, 16px);
            padding: 24px;
            transition: var(--lt-transition-normal);
        }
        
        .dashboard-section:hover {
            border-color: var(--lt-primary, #00d4ff);
            box-shadow: var(--lt-shadow-glow);
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--lt-border, #30363d);
        }
        
        .section-title {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .section-title h2 {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--lt-text-primary, #e6edf3);
            margin: 0;
        }
        
        .section-title .section-icon { font-size: 1.5rem; }
        .section-subtitle { color: var(--lt-text-secondary, #8b949e); font-size: 0.875rem; margin-top: 4px; }
        .section-actions { display: flex; gap: 8px; }
        
        .section-btn {
            padding: 8px 16px;
            background: transparent;
            border: 1px solid var(--lt-border-accent);
            color: var(--lt-primary);
            border-radius: var(--lt-radius-md);
            cursor: pointer;
            font-size: 0.875rem;
            transition: var(--lt-transition-fast);
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .section-btn:hover { background: rgba(0, 212, 255, 0.1); border-color: var(--lt-primary); }
        .section-btn.primary { background: linear-gradient(135deg, var(--lt-primary), var(--lt-accent)); border: none; color: #fff; }
        .section-btn.primary:hover { transform: translateY(-2px); box-shadow: var(--lt-shadow-glow); }
        
        .welcome-section { background: linear-gradient(135deg, rgba(0, 212, 255, 0.1), rgba(118, 75, 162, 0.1)); }
        .welcome-content { display: flex; flex-direction: column; gap: 16px; }
        .welcome-greeting { display: flex; align-items: center; gap: 16px; }
        
        .welcome-avatar {
            width: 60px; height: 60px; border-radius: 50%;
            background: linear-gradient(135deg, var(--lt-primary), var(--lt-secondary));
            display: flex; align-items: center; justify-content: center;
            font-size: 1.5rem; color: #fff; border: 2px solid var(--lt-border-accent);
        }
        
        .welcome-text h1 { font-size: 1.5rem; color: var(--lt-text-primary); margin: 0; }
        .welcome-text p { color: var(--lt-text-secondary); margin: 4px 0 0 0; font-size: 0.9rem; }
        
        .welcome-last-activity {
            display: flex; align-items: center; gap: 8px; padding: 12px 16px;
            background: rgba(0, 212, 255, 0.05); border-radius: var(--lt-radius-md);
            color: var(--lt-text-secondary); font-size: 0.875rem;
        }
        .welcome-last-activity i { color: var(--lt-primary); }
        
        .tandas-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 16px; }
        
        .tanda-card {
            background: var(--lt-bg-dark); border: 1px solid var(--lt-border);
            border-radius: var(--lt-radius-md); padding: 16px; transition: var(--lt-transition-fast);
        }
        .tanda-card:hover { border-color: var(--lt-primary); transform: translateY(-2px); }
        .tanda-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 12px; }
        .tanda-name { font-weight: 600; color: var(--lt-text-primary); display: flex; align-items: center; gap: 8px; }
        .tanda-name i { color: var(--lt-primary); }
        .tanda-role { font-size: 0.75rem; padding: 4px 8px; border-radius: 4px; background: rgba(0, 212, 255, 0.1); color: var(--lt-primary); }
        .tanda-info { display: flex; flex-direction: column; gap: 8px; font-size: 0.875rem; color: var(--lt-text-secondary); }
        .tanda-progress { margin-top: 12px; }
        .progress-bar { height: 6px; background: var(--lt-bg-hover); border-radius: 3px; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, var(--lt-primary), var(--lt-accent)); transition: width 0.3s ease; }
        .progress-text { display: flex; justify-content: space-between; font-size: 0.75rem; color: var(--lt-text-muted); margin-top: 4px; }
        .no-tandas { text-align: center; padding: 40px; color: var(--lt-text-secondary); }
        .no-tandas i { font-size: 3rem; color: var(--lt-text-muted); margin-bottom: 16px; display: block; }
        
        .actions-market-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; }
        @media (max-width: 768px) { .actions-market-grid { grid-template-columns: 1fr; } }
        .actions-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; }
        
        .action-btn {
            display: flex; flex-direction: column; align-items: center; gap: 8px;
            padding: 20px 16px; background: var(--lt-bg-dark); border: 1px solid var(--lt-border);
            border-radius: var(--lt-radius-md); cursor: pointer; transition: var(--lt-transition-fast); color: var(--lt-text-primary);
        }
        .action-btn:hover { border-color: var(--lt-primary); background: rgba(0, 212, 255, 0.05); transform: translateY(-2px); }
        .action-btn i { font-size: 1.5rem; color: var(--lt-primary); }
        .action-btn span { font-size: 0.875rem; }
        
        .market-section { position: relative; }
        .coming-soon-overlay {
            position: absolute; inset: 0; background: rgba(13, 17, 23, 0.8); backdrop-filter: blur(4px);
            display: flex; align-items: center; justify-content: center; border-radius: var(--lt-radius-md); z-index: 1;
        }
        .coming-soon-badge { background: linear-gradient(135deg, var(--lt-secondary), var(--lt-accent)); padding: 12px 24px; border-radius: var(--lt-radius-md); font-weight: 600; color: #fff; }
        
        .crypto-list { display: flex; flex-direction: column; gap: 12px; }
        .crypto-item { display: flex; justify-content: space-between; align-items: center; padding: 12px; background: var(--lt-bg-dark); border-radius: var(--lt-radius-sm); }
        .crypto-name { font-weight: 500; color: var(--lt-text-primary); }
        .crypto-price { text-align: right; }
        .crypto-price .price { color: var(--lt-text-primary); }
        .crypto-price .change { font-size: 0.75rem; }
        .crypto-price .change.positive { color: #3fb950; }
        .crypto-price .change.negative { color: #f85149; }
        
        .activity-list { display: flex; flex-direction: column; gap: 0; }
        .activity-item-new { display: flex; align-items: center; gap: 16px; padding: 16px 0; border-bottom: 1px solid var(--lt-border); }
        .activity-item-new:last-child { border-bottom: none; }
        .activity-icon-wrapper { width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
        .activity-icon-wrapper.completed { background: rgba(63, 185, 80, 0.1); color: #3fb950; }
        .activity-icon-wrapper.pending { background: rgba(210, 153, 34, 0.1); color: #d29922; }
        .activity-icon-wrapper.received { background: rgba(0, 212, 255, 0.1); color: var(--lt-primary); }
        .activity-details { flex: 1; }
        .activity-title-text { font-weight: 500; color: var(--lt-text-primary); }
        .activity-subtitle { font-size: 0.875rem; color: var(--lt-text-secondary); }
        .activity-meta { text-align: right; }
        .activity-amount-text { font-weight: 600; color: var(--lt-text-primary); }
        .activity-time-text { font-size: 0.75rem; color: var(--lt-text-muted); }
        
        .footer-stats { display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; }
        @media (max-width: 768px) { .footer-stats { grid-template-columns: repeat(2, 1fr); } }
        .footer-stat { text-align: center; padding: 16px; }
        .footer-stat-value { font-size: 1.5rem; font-weight: 700; color: var(--lt-primary); }
        .footer-stat-label { font-size: 0.875rem; color: var(--lt-text-secondary); margin-top: 4px; }
        @media (max-width: 640px) { .tandas-grid { grid-template-columns: 1fr; } .welcome-greeting { flex-direction: column; text-align: center; } }
        /* Hide old duplicate sections - replaced by new dashboard-sections */
        .quick-actions:not(.actions-grid),
        .recent-activity,
        .flash-cards-container {
            display: none !important;
        }



        </style>
    <!-- Notification Center Component -->
    <link rel="stylesheet" href="css/components/notification-center.css">
    <!-- Wallet Dropdown Component -->
    <link rel="stylesheet" href="css/components/wallet-dropdown.css">
    <!-- Mobile Touch & Positioning Fixes -->
    <link rel="stylesheet" href="css/mobile-touch-fixes.css">
    <link rel="stylesheet" href="css/mobile-notification-fix.css">
    <!-- Mobile Network Switcher Emergency Fix -->
    <link rel="stylesheet" href="css/mobile-network-switcher-fix.css">
    <!-- Mobile Wallet Connection Fix -->
    <link rel="stylesheet" href="css/mobile-wallet-connect-fix.css">
    <!-- Transaction Modal Component -->
    <link rel="stylesheet" href="css/transaction-modal.css">
    <!-- Global Header Component -->
    <link rel="stylesheet" href="css/variables.css">
    <link rel="stylesheet" href="css/header.css">
</head>
<body data-sidebar="true">
    <!-- Global Header Container -->
    <div id="global-header"></div>

    <!-- Web3 Background Effects -->
    <div class="bg-effects">
        <div class="gradient-orb gradient-orb-1"></div>
        <div class="gradient-orb gradient-orb-2"></div>
        <div class="gradient-orb gradient-orb-3"></div>
    </div>

    <!-- OLD SIDEBAR REMOVED - Using modular sidebar component -->

    <div class="container">
        <!-- Modern Web3 Header -->
        
        <header class="page-header" style="display:none;">
            <div class="header-top-row">
                <div class="header-left-section">
                    <button class="hamburger-menu" onclick="toggleMenu()">
                        <i class="fas fa-bars"></i>
                    </button>
                    <div class="logo-container">
                        <div class="logo-img">
                            <img src="assets/logo-latanda-latest.png" alt="La Tanda Logo">
                        </div>
                        <div class="header-title">
                            <h1>La Tanda</h1>
                            <p class="header-subtitle" data-i18n="dashboard.web3_protocol">Web3 Protocol</p>
                        </div>
                    </div>
                </div>
                
                <div class="header-center-section">
                    <div class="blockchain-status">
                        <div class="chain-indicator">
                            <div class="chain-dot"></div>
                            <span>La Tanda Chain</span>
                        </div>
                        <span>Block: 2,847,392</span>
                        <span>Gas: 12 gwei</span>
                        <span>Latency: 2.3s</span>
                    </div>
                    
                                        <!-- Network Switcher - Component 3 -->
                    <div class="network-switcher">
                        <div class="network-icon" style="background: linear-gradient(135deg, #627EEA, #4E5C9E);">
                            <i class="fab fa-ethereum" style="color: white;"></i>
                        </div>
                        <div class="network-info">
                            <div class="network-name" id="current-network-name">Ethereum</div>
                            <div class="network-status">
                                <div class="status-dot"></div>
                                <span id="network-latency">12 ms</span>
                            </div>
                        </div>
                        <i class="fas fa-chevron-down" style="font-size: 8px; color: var(--text-secondary);"></i>
                        
                        <!-- Network Dropdown -->
                        <div class="network-dropdown" id="network-dropdown" style="display: none;">
                            <div class="network-dropdown-header">
                                <div class="network-dropdown-title">Select Network</div>
                            </div>
                            
                            <div class="network-option active" data-network="ethereum">
                                <div class="network-option-icon" style="background: linear-gradient(135deg, #627EEA, #4E5C9E);">
                                    <i class="fab fa-ethereum" style="color: white;"></i>
                                </div>
                                <div class="network-option-info">
                                    <div class="network-option-name">Ethereum</div>
                                    <div class="network-option-chain">ETH Mainnet</div>
                                </div>
                            </div>
                            
                            <div class="network-option" data-network="polygon">
                                <div class="network-option-icon" style="background: linear-gradient(135deg, #8247E5, #5C2B99);">
                                    <span style="color: white;">‚¨°</span>
                                </div>
                                <div class="network-option-info">
                                    <div class="network-option-name">Polygon</div>
                                    <div class="network-option-chain">MATIC Mainnet</div>
                                </div>
                            </div>
                            
                            <div class="network-option" data-network="bsc">
                                <div class="network-option-icon" style="background: linear-gradient(135deg, #F3BA2F, #E6A820);">
                                    <span style="color: black;">B</span>
                                </div>
                                <div class="network-option-info">
                                    <div class="network-option-name">BSC</div>
                                    <div class="network-option-chain">BNB Smart Chain</div>
                                </div>
                            </div>
                            
                            <div class="network-option" data-network="arbitrum">
                                <div class="network-option-icon" style="background: linear-gradient(135deg, #28A0F0, #1E7DBF);">
                                    <span style="color: white;">A</span>
                                </div>
                                <div class="network-option-info">
                                    <div class="network-option-name">Arbitrum</div>
                                    <div class="network-option-chain">ARB One</div>
                                </div>
                            </div>
                            
                            <div class="network-option" data-network="optimism">
                                <div class="network-option-icon" style="background: linear-gradient(135deg, #FF0420, #CC0319);">
                                    <span style="color: white;">O</span>
                                </div>
                                <div class="network-option-info">
                                    <div class="network-option-name">Optimism</div>
                                    <div class="network-option-chain">OP Mainnet</div>
                                </div>
                            </div>
                        </div>
                    </div>

<div class="wallet-connect" data-wallet-toggle>
<div class="wallet-info" onclick="walletDropdown.toggle()" style="cursor: pointer;">                            <div class="wallet-address">Connect Wallet</div>                            <div class="wallet-balance" data-balance-ltd>0.00 LTD</div>                        </div>                        <button class="wallet-toggle-visibility" onclick="event.stopPropagation(); toggleBalanceVisibility();" title="Hide/Show Balance">                            <i class="fas fa-eye" id="walletEyeIcon"></i>                        </button>
                    </div>
                </div>

                <div class="header-right-section">
                    <div class="header-advanced-controls">
                        <div class="tx-progress">
                            <span class="tx-counter">3 Tx</span>
                            <div class="tx-progress-bar">
                                <div class="tx-progress-fill"></div>
                            </div>
                        </div>
                        
                        <div class="security-alerts">
                            <i class="fas fa-shield-alt alert-icon"></i>
                            <span>Secure</span>
                        </div>
                        
                        <div class="preferences-toggle" onclick="togglePreferences()" id="preferencesToggle">
                            <i class="fas fa-globe-americas"></i>
                            <i class="fas fa-chevron-down toggle-arrow"></i>
                        </div>
                    </div>
                    
                    <div class="header-quick-actions">
                        <button class="header-action-btn" onclick="notificationCenter.toggle()" title="Notificaciones">
                            <i class="fas fa-bell"></i>
                            <div class="notification-dot"></div>
                        </button>
                        <button class="header-action-btn" onclick="transactionModal.open()" title="Send/Receive">
                            <i class="fas fa-exchange-alt"></i>
                        </button>
                        <button class="header-action-btn" onclick="showQuickSearch()" title="B√∫squeda">
                            <i class="fas fa-search"></i>
                        </button>
                        <button class="header-action-btn" onclick="openProfileEditor()" title="Editar Perfil">
                            <i class="fas fa-user-cog"></i>
                        </button>
                    </div>
                </div>
            </div>
        </header>
        <!-- END OLD HEADER -->

        <!-- Crypto Ticker -->
        <div class="crypto-ticker" style="display: none;">
            <div class="ticker-content" id="cryptoTicker">
                <div class="ticker-item">
                    <span class="ticker-symbol">LTD</span>
                    <span class="ticker-price">$0.847</span>
                    <span class="ticker-change ticker-positive">+45.7%</span>
                </div>
                <div class="ticker-item">
                    <span class="ticker-event">
                        <i class="fas fa-users ticker-event-icon"></i>
                        <span>Nueva Tanda Premium iniciando - 50 miembros</span>
                    </span>
                </div>
                <div class="ticker-item">
                    <span class="ticker-symbol">BTC</span>
                    <span class="ticker-price">$43,250</span>
                    <span class="ticker-change ticker-positive">+2.1%</span>
                </div>
                <div class="ticker-item">
                    <span class="ticker-event">
                        <i class="fas fa-trophy ticker-event-icon"></i>
                        <span>Recompensas de Staking: +2,847 LTD distribuidos hoy</span>
                    </span>
                </div>
                <div class="ticker-item">
                    <span class="ticker-symbol">ETH</span>
                    <span class="ticker-price">$2,680</span>
                    <span class="ticker-change ticker-positive">+3.4%</span>
                </div>
                <div class="ticker-item">
                    <span class="ticker-event">
                        <i class="fas fa-vote-yea ticker-event-icon"></i>
                        <span>Propuesta de Governance #47 - 89% aprobaci√≥n</span>
                    </span>
                </div>
                <div class="ticker-item">
                    <span class="ticker-symbol">BNB</span>
                    <span class="ticker-price">$312.45</span>
                    <span class="ticker-change ticker-negative">-1.2%</span>
                </div>
                <div class="ticker-item">
                    <span class="ticker-event">
                        <i class="fas fa-fire ticker-event-icon"></i>
                        <span>1,247 usuarios activos en las √∫ltimas 24h</span>
                    </span>
                </div>
                <div class="ticker-item">
                    <span class="ticker-symbol">MATIC</span>
                    <span class="ticker-price">$0.89</span>
                    <span class="ticker-change ticker-positive">+8.3%</span>
                </div>
                <div class="ticker-item">
                    <span class="ticker-event">
                        <i class="fas fa-chart-line ticker-event-icon"></i>
                        <span>TVL alcanz√≥ $2.8M - R√©cord hist√≥rico</span>
                    </span>
                </div>
                <div class="ticker-item">
                    <span class="ticker-symbol">ADA</span>
                    <span class="ticker-price">$0.52</span>
                    <span class="ticker-change ticker-positive">+5.7%</span>
                </div>
                <div class="ticker-item">
                    <span class="ticker-event">
                        <i class="fas fa-handshake ticker-event-icon"></i>
                        <span>23 nuevas asociaciones confirmadas esta semana</span>
                    </span>
                </div>
                <div class="ticker-item">
                    <span class="ticker-symbol">DOT</span>
                    <span class="ticker-price">$7.24</span>
                    <span class="ticker-change ticker-positive">+6.8%</span>
                </div>
                <div class="ticker-item">
                    <span class="ticker-event">
                        <i class="fas fa-shield-alt ticker-event-icon"></i>
                        <span>Auditor√≠a de seguridad completada - 100% seguro</span>
                    </span>
                </div>
            </div>
        </div>

        
        <!-- ============================================
             NEW DASHBOARD SECTIONS
             ============================================ -->
        <div class="dashboard-sections" id="dashboardSections">
            
            <!-- SECTION 1: BIENVENIDA -->
            <section class="dashboard-section welcome-section" id="welcomeSection">
                <div class="welcome-content">
                    <div class="welcome-greeting">
                        <div class="welcome-avatar" id="userAvatar">
                            <i class="fas fa-user"></i>
                        </div>
                        <div class="welcome-text">
                            <h1 id="welcomeTitle">Hola, Usuario!</h1>
                            <p>Bienvenido a La Tanda</p>
                        </div>
                    </div>
                    
                    <div id="carouselWrapper">

        <!-- Main Stats Carousel Section -->
        <div class="stats-carousel-container">
            <div class="stats-carousel" id="statsCarousel">
                <!-- Slide 1: Overview Principal -->
                <div class="stats-slide">
                    <div class="slide-title">üìä Overview Principal</div>
                    <div class="stats-grid">
                        <div class="stat-card" data-metric="userBalance">
                        <div class="stat-header">
                            <div class="stat-icon">
                                <i class="fas fa-wallet"></i>
                            </div>
                            <div class="stat-trend trend-positive">
                                <i class="fas fa-arrow-up"></i> +12.5%
                            </div>
                        </div>
                        <div class="stat-label" data-i18n="home_dashboard.balance_total">Balance Total</div>
                        <div class="stat-value">24,567.89 LTD</div>
                        <div class="stat-subtitle">‚âà $20,883.71 USD</div>
                    </div>

                    <div class="stat-card" data-metric="stakingRewards">
                        <div class="stat-header">
                            <div class="stat-icon" style="background: linear-gradient(135deg, var(--crypto-gold), #e6c200);">
                                <i class="fas fa-coins"></i>
                            </div>
                            <div class="stat-trend trend-positive">
                                <i class="fas fa-arrow-up"></i> +8.3%
                            </div>
                        </div>
                        <div class="stat-label" data-i18n="home_dashboard.staking_rewards">Staking Rewards</div>
                        <div class="stat-value">1,847.23 LTD</div>
                        <div class="stat-subtitle">145% APY Promedio</div>
                    </div>

                    <div class="stat-card" data-metric="activeTandas">
                        <div class="stat-header">
                            <div class="stat-icon" style="background: linear-gradient(135deg, #8b5cf6, #a855f7);">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="stat-trend trend-positive">
                                <i class="fas fa-arrow-up"></i> +5
                            </div>
                        </div>
                        <div class="stat-label" data-i18n="home_dashboard.active_tandas">Tandas Activas</div>
                        <div class="stat-value">12</div>
                        <div class="stat-subtitle">3 como coordinador</div>
                    </div>

                    <div class="stat-card" data-metric="ltdPrice">
                        <div class="stat-header">
                            <div class="stat-icon" style="background: linear-gradient(135deg, #22d55e, #16a34a);">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div class="stat-trend trend-positive">
                                <i class="fas fa-arrow-up"></i> +45.7%
                            </div>
                        </div>
                        <div class="stat-label" data-i18n="home_dashboard.ltd_price">Precio LTD</div>
                        <div class="stat-value">$0.847</div>
                        <div class="stat-subtitle">Market Cap: $2.4M</div>
                        </div>
                    </div>
                </div>

                <!-- Slide 2: DeFi Metrics -->
                <div class="stats-slide">
                    <div class="slide-title">‚ö° DeFi Metrics</div>
                    <div class="stats-grid">
                        <div class="stat-card" data-metric="tvl">
                        <div class="stat-header">
                            <div class="stat-icon" style="background: linear-gradient(135deg, #f59e0b, #d97706);">
                                <i class="fas fa-fire"></i>
                            </div>
                            <div class="stat-trend trend-positive">
                                <i class="fas fa-arrow-up"></i> +23.1%
                            </div>
                        </div>
                        <div class="stat-label" data-i18n="home_dashboard.total_value_locked">Total Value Locked</div>
                        <div class="stat-value">847.2K LTD</div>
                        <div class="stat-subtitle">‚âà $717,200 USD</div>
                    </div>

                    <div class="stat-card" data-metric="tradingVolume">
                        <div class="stat-header">
                            <div class="stat-icon" style="background: linear-gradient(135deg, #ef4444, #dc2626);">
                                <i class="fas fa-chart-area"></i>
                            </div>
                            <div class="stat-trend trend-positive">
                                <i class="fas fa-arrow-up"></i> +15.7%
                            </div>
                        </div>
                        <div class="stat-label" data-i18n="home_dashboard.trading_volume_24h">Trading Volume 24h</div>
                        <div class="stat-value">156.8K LTD</div>
                        <div class="stat-subtitle">78 transacciones</div>
                    </div>

                    <div class="stat-card" data-metric="liquidityPools">
                        <div class="stat-header">
                            <div class="stat-icon" style="background: linear-gradient(135deg, #06b6d4, #0891b2);">
                                <i class="fas fa-swimming-pool"></i>
                            </div>
                            <div class="stat-trend trend-positive">
                                <i class="fas fa-arrow-up"></i> +9.2%
                            </div>
                        </div>
                        <div class="stat-label" data-i18n="home_dashboard.liquidity_pools">Liquidity Pools</div>
                        <div class="stat-value">8</div>
                        <div class="stat-subtitle">$1.2M liquidez total</div>
                    </div>

                    <div class="stat-card" data-metric="lendingRewards">
                        <div class="stat-header">
                            <div class="stat-icon" style="background: linear-gradient(135deg, #10b981, #059669);">
                                <i class="fas fa-hand-holding-usd"></i>
                            </div>
                            <div class="stat-trend trend-positive">
                                <i class="fas fa-arrow-up"></i> +31.4%
                            </div>
                        </div>
                        <div class="stat-label" data-i18n="home_dashboard.lending_rewards">Lending Rewards</div>
                        <div class="stat-value">234.5 LTD</div>
                        <div class="stat-subtitle">187% APY</div>
                        </div>
                    </div>
                </div>

                <!-- Slide 3: Governance & Social -->
                <div class="stats-slide">
                    <div class="slide-title">üó≥Ô∏è Governance & Social</div>
                    <div class="stats-grid">
                        <div class="stat-card" data-metric="activeProposals">
                        <div class="stat-header">
                            <div class="stat-icon" style="background: linear-gradient(135deg, #8b5cf6, #7c3aed);">
                                <i class="fas fa-vote-yea"></i>
                            </div>
                            <div class="stat-trend trend-positive">
                                <i class="fas fa-arrow-up"></i> +7
                            </div>
                        </div>
                        <div class="stat-label">Propuestas Activas</div>
                        <div class="stat-value">4</div>
                        <div class="stat-subtitle">73% participaci√≥n</div>
                    </div>

                    <div class="stat-card" data-metric="nftMemberships">
                        <div class="stat-header">
                            <div class="stat-icon" style="background: linear-gradient(135deg, #ec4899, #db2777);">
                                <i class="fas fa-gem"></i>
                            </div>
                            <div class="stat-trend trend-positive">
                                <i class="fas fa-arrow-up"></i> +12
                            </div>
                        </div>
                        <div class="stat-label">NFT Memberships</div>
                        <div class="stat-value">3</div>
                        <div class="stat-subtitle">Elite, Gold, Silver</div>
                    </div>

                    <div class="stat-card" data-metric="activeCommunity">
                        <div class="stat-header">
                            <div class="stat-icon" style="background: linear-gradient(135deg, #f97316, #ea580c);">
                                <i class="fas fa-users-cog"></i>
                            </div>
                            <div class="stat-trend trend-positive">
                                <i class="fas fa-arrow-up"></i> +28
                            </div>
                        </div>
                        <div class="stat-label">Comunidad Activa</div>
                        <div class="stat-value">1,247</div>
                        <div class="stat-subtitle">usuarios conectados</div>
                    </div>

                    <div class="stat-card" data-metric="totalReferrals">
                        <div class="stat-header">
                            <div class="stat-icon" style="background: linear-gradient(135deg, #14b8a6, #0d9488);">
                                <i class="fas fa-handshake"></i>
                            </div>
                            <div class="stat-trend trend-positive">
                                <i class="fas fa-arrow-up"></i> +156
                            </div>
                        </div>
                        <div class="stat-label">Referidos Totales</div>
                        <div class="stat-value">892</div>
                        <div class="stat-subtitle">+45 esta semana</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Carousel Controls -->
            <div class="carousel-controls">
                <button class="carousel-btn" onclick="previousSlide()">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <div class="carousel-indicators">
                    <div class="carousel-dot active" onclick="goToSlide(0)"></div>
                    <div class="carousel-dot" onclick="goToSlide(1)"></div>
                    <div class="carousel-dot" onclick="goToSlide(2)"></div>
                </div>
                <button class="carousel-btn" onclick="nextSlide()">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
        </div>
                    </div>
                    
                    <div class="welcome-last-activity" id="lastActivity">
                        <i class="fas fa-clock"></i>
                        <span id="lastActivityText">Cargando ultima actividad...</span>
                    </div>
                </div>
            </section>
            
            <!-- SECTION 2: MIS TANDAS -->
            <section class="dashboard-section" id="misTandasSection">
                <div class="section-header">
                    <div class="section-title">
                        <span class="section-icon">&#127919;</span>
                        <div>
                            <h2>Mis Tandas</h2>
                            <p class="section-subtitle" id="tandasSummary">Cargando...</p>
                        </div>
                    </div>
                    <div class="section-actions">
                        <button class="section-btn primary" onclick="openCreateTandaModal && openCreateTandaModal()">
                            <i class="fas fa-plus"></i> Crear Nueva
                        </button>
                    </div>
                </div>
                <div class="tandas-grid" id="tandasGrid">
                    <div class="no-tandas">
                        <i class="fas fa-spinner fa-spin"></i>
                        <p>Cargando tandas...</p>
                    </div>
                </div>
            </section>
            
            <!-- SECTION 3: ACCIONES + MERCADO -->
            <section class="dashboard-section" id="actionsMarketSection">
                <div class="actions-market-grid">
                    <div class="actions-column">
                        <div class="section-header">
                            <div class="section-title">
                                <span class="section-icon">&#9889;</span>
                                <h2>Acciones Rapidas</h2>
                            </div>
                        </div>
                        <div class="actions-grid">
                            <button class="action-btn" onclick="openSendModal && openSendModal()">
                                <i class="fas fa-paper-plane"></i>
                                <span>Enviar Dinero</span>
                            </button>
                            <button class="action-btn" onclick="openReceiveModal && openReceiveModal()">
                                <i class="fas fa-qrcode"></i>
                                <span>Recibir</span>
                            </button>
                            <button class="action-btn" onclick="openCreateTandaModal && openCreateTandaModal()">
                                <i class="fas fa-users"></i>
                                <span>Nueva Tanda</span>
                            </button>
                            <button class="action-btn" onclick="window.location.href='my-wallet.html'">
                                <i class="fas fa-history"></i>
                                <span>Historial</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="market-column market-section">
                        <div class="coming-soon-overlay">
                            <div class="coming-soon-badge">
                                <i class="fas fa-lock"></i> Proximamente
                            </div>
                        </div>
                        <div class="section-header">
                            <div class="section-title">
                                <span class="section-icon">&#128200;</span>
                                <h2>Mercado</h2>
                            </div>
                        </div>
                        <div class="crypto-list">
                            <div class="crypto-item">
                                <span class="crypto-name">BTC</span>
                                <div class="crypto-price">
                                    <div class="price">$43,250</div>
                                    <div class="change positive">&#9650; 2.1%</div>
                                </div>
                            </div>
                            <div class="crypto-item">
                                <span class="crypto-name">ETH</span>
                                <div class="crypto-price">
                                    <div class="price">$2,680</div>
                                    <div class="change positive">&#9650; 3.4%</div>
                                </div>
                            </div>
                            <div class="crypto-item">
                                <span class="crypto-name">LTD</span>
                                <div class="crypto-price">
                                    <div class="price">$0.847</div>
                                    <div class="change positive">&#9650; 1.2%</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- SECTION 4: ACTIVIDAD RECIENTE -->
            <section class="dashboard-section" id="activitySection">
                <div class="section-header">
                    <div class="section-title">
                        <span class="section-icon">&#128203;</span>
                        <h2>Actividad Reciente</h2>
                    </div>
                    <button class="section-btn" onclick="window.location.href='my-wallet.html'">
                        Ver todo <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
                <div class="activity-list" id="activityList">
                    <div class="no-tandas">
                        <i class="fas fa-spinner fa-spin"></i>
                        <p>Cargando actividad...</p>
                    </div>
                </div>
            </section>
            
            <!-- SECTION 5: FOOTER STATS -->
            <section class="dashboard-section" id="footerStatsSection">
                <div class="section-header">
                    <div class="section-title">
                        <span class="section-icon">&#127942;</span>
                        <h2>Tu Progreso en La Tanda</h2>
                    </div>
                </div>
                <div class="footer-stats">
                    <div class="footer-stat">
                        <div class="footer-stat-value" id="statTandasCompleted">0</div>
                        <div class="footer-stat-label">Tandas Completadas</div>
                    </div>
                    <div class="footer-stat">
                        <div class="footer-stat-value" id="statTotalSaved">L.0</div>
                        <div class="footer-stat-label">Ahorro Total</div>
                    </div>
                    <div class="footer-stat">
                        <div class="footer-stat-value" id="statPunctuality">--%</div>
                        <div class="footer-stat-label">Puntualidad</div>
                    </div>
                    <div class="footer-stat">
                        <div class="footer-stat-value" id="statMemberSince">--</div>
                        <div class="footer-stat-label">Miembro Desde</div>
                    </div>
                </div>
            </section>
            
        </div>
        <!-- END DASHBOARD SECTIONS -->


        <!-- Quick Actions Section -->
        <div class="quick-actions">
            <h2 class="section-title">
                <i class="fas fa-bolt"></i> Acciones R√°pidas
            </h2>
            <div class="actions-grid">
                <div class="action-item" onclick="openSendLTDModal()">
                    <div class="action-icon"><i class="fas fa-paper-plane"></i></div>
                    <div class="action-title">Enviar LTD</div>
                    <div class="action-description">Transferir tokens instant√°neamente</div>
                </div>
                <div class="action-item" onclick="openCreateTandaModal()">
                    <div class="action-icon"><i class="fas fa-plus-circle"></i></div>
                    <div class="action-title">Crear Tanda</div>
                    <div class="action-description">Iniciar nuevo grupo de ahorro</div>
                </div>
                <div class="action-item" onclick="openStakeLTDModal()">
                    <div class="action-icon"><i class="fas fa-seedling"></i></div>
                    <div class="action-title">Stake LTD</div>
                    <div class="action-description">Ganar rewards autom√°ticos</div>
                </div>
                <div class="action-item" onclick="openTradingModal()">
                    <div class="action-icon"><i class="fas fa-exchange-alt"></i></div>
                    <div class="action-title">Trading</div>
                    <div class="action-description">Intercambiar criptomonedas</div>
                </div>
                <div class="action-item" onclick="openMarketplaceModal()">
                    <div class="action-icon"><i class="fas fa-shopping-bag"></i></div>
                    <div class="action-title">Marketplace</div>
                    <div class="action-description">Comprar con LTD</div>
                </div>
                <div class="action-item" onclick="openGovernanceModal()">
                    <div class="action-icon"><i class="fas fa-vote-yea"></i></div>
                    <div class="action-title">Governance</div>
                    <div class="action-description">Votar propuestas DAO</div>
                </div>
            </div>
        </div>

        <!-- Recent Activity Section -->
        <div class="recent-activity">
            <h2 class="section-title">
                <i class="fas fa-clock"></i> Actividad Reciente
            </h2>
            <div class="activity-item">
                <div class="activity-icon">
                    <i class="fas fa-plus"></i>
                </div>
                <div class="activity-content">
                    <div class="activity-title">Staking Reward Recibido</div>
                    <div class="activity-time">Hace 2 horas</div>
                </div>
                <div class="activity-amount">+127.45 LTD</div>
            </div>
            <div class="activity-item">
                <div class="activity-icon" style="background: linear-gradient(135deg, #8b5cf6, #a855f7);">
                    <i class="fas fa-users"></i>
                </div>
                <div class="activity-content">
                    <div class="activity-title">Te uniste a Tanda Premium #847</div>
                    <div class="activity-time">Hace 5 horas</div>
                </div>
                <div class="activity-amount">-5,000 LTD</div>
            </div>
            <div class="activity-item">
                <div class="activity-icon" style="background: linear-gradient(135deg, var(--crypto-gold), #e6c200);">
                    <i class="fas fa-vote-yea"></i>
                </div>
                <div class="activity-content">
                    <div class="activity-title">Votaste en propuesta #23</div>
                    <div class="activity-time">Hace 1 d√≠a</div>
                </div>
                <div class="activity-amount">+5 LTD</div>
            </div>
            <div class="activity-item">
                <div class="activity-icon" style="background: linear-gradient(135deg, #22d55e, #16a34a);">
                    <i class="fas fa-exchange-alt"></i>
                </div>
                <div class="activity-content">
                    <div class="activity-title">Swap ETH ‚Üí LTD completado</div>
                    <div class="activity-time">Hace 2 d√≠as</div>
                </div>
                <div class="activity-amount">+2,450 LTD</div>
            </div>
        </div>

        <!-- Flash Cards Grid -->
        <div class="flash-cards-container">
            <!-- Trending Flash Card -->
            <div class="flash-card trending-card" data-category="trending">
                <div class="card-glow"></div>
                <div class="card-header">
                    <i class="fas fa-fire card-icon" style="color: #ff6b35;"></i>
                    <span class="card-badge" style="background: linear-gradient(135deg, #ff6b35, #ff8c42);">TRENDING</span>
                </div>
                <div class="card-content">
                    <div class="card-title">üî• Explosi√≥n de Staking</div>
                    <div class="card-description">+127% en nuevos pools esta semana</div>
                    <div class="card-value">2.3M LTD Staked</div>
                </div>
                <div class="card-action">
                    <div class="card-trend trend-up">
                        <i class="fas fa-arrow-up"></i>
                        <span>145% APY Promedio</span>
                    </div>
                    <button class="action-btn" onclick="navigateToSection('staking')">Explorar</button>
                </div>
            </div>

            <!-- Opportunities Flash Card -->
            <div class="flash-card opportunity-card" data-category="opportunities">
                <div class="card-glow"></div>
                <div class="card-header">
                    <i class="fas fa-bullseye card-icon" style="color: var(--crypto-gold);"></i>
                    <span class="card-badge" style="background: linear-gradient(135deg, var(--crypto-gold), #ffed4e);">OPORTUNIDAD</span>
                </div>
                <div class="card-content">
                    <div class="card-title">üíé Tanda Premium Abierta</div>
                    <div class="card-description">Solo 3 espacios disponibles</div>
                    <div class="card-value">5,000 LTD m√≠nimo</div>
                </div>
                <div class="card-action">
                    <div class="card-trend trend-up">
                        <i class="fas fa-gem"></i>
                        <span>Rewards exclusivos</span>
                    </div>
                    <button class="action-btn" onclick="navigateToSection('groups')">Unirse Ahora</button>
                </div>
            </div>

            <!-- Events Flash Card -->
            <div class="flash-card event-card" data-category="events">
                <div class="card-glow"></div>
                <div class="card-header">
                    <i class="fas fa-calendar-alt card-icon" style="color: #8b5cf6;"></i>
                    <span class="card-badge" style="background: linear-gradient(135deg, #8b5cf6, #a855f7);">EVENTO</span>
                </div>
                <div class="card-content">
                    <div class="card-title">üéØ Governance Vote</div>
                    <div class="card-description">Termina en 2 d√≠as 14 horas</div>
                    <div class="card-value">73% participaci√≥n</div>
                </div>
                <div class="card-action">
                    <div class="card-trend trend-up">
                        <i class="fas fa-vote-yea"></i>
                        <span>Activo</span>
                    </div>
                    <button class="action-btn" onclick="navigateToSection('governance')">Votar</button>
                </div>
            </div>

            <!-- Innovation Flash Card -->
            <div class="flash-card innovation-card" data-category="innovation">
                <div class="card-glow"></div>
                <div class="card-header">
                    <i class="fas fa-lightbulb card-icon" style="color: #06d6a0;"></i>
                    <span class="card-badge" style="background: linear-gradient(135deg, #06d6a0, #26ffc6);">INNOVACI√ìN</span>
                </div>
                <div class="card-content">
                    <div class="card-title">‚ö° Nueva Funcionalidad</div>
                    <div class="card-description">Cross-chain Bridge activado</div>
                    <div class="card-value">Ethereum ‚Ä¢ Polygon ‚Ä¢ BSC</div>
                </div>
                <div class="card-action">
                    <div class="card-trend trend-up">
                        <i class="fas fa-link"></i>
                        <span>Multi-chain</span>
                    </div>
                    <button class="action-btn" onclick="navigateToSection('bridge')">Explorar</button>
                </div>
            </div>

            <!-- Market Flash Card -->
            <div class="flash-card market-card" data-category="market">
                <div class="card-glow"></div>
                <div class="card-header">
                    <i class="fas fa-chart-line card-icon" style="color: #f72585;"></i>
                    <span class="card-badge" style="background: linear-gradient(135deg, #f72585, #ff6b9d);">MERCADO</span>
                </div>
                <div class="card-content">
                    <div class="card-title">üìà LTD Price Action</div>
                    <div class="card-description">+45.7% en las √∫ltimas 24h</div>
                    <div class="card-value">$0.847 +$0.267</div>
                </div>
                <div class="card-action">
                    <div class="card-trend trend-up">
                        <i class="fas fa-arrow-up"></i>
                        <span>Market Cap: $2.4M</span>
                    </div>
                    <button class="action-btn" onclick="navigateToSection('trading')">Trade</button>
                </div>
            </div>

            <!-- Social Flash Card -->
            <div class="flash-card social-card" data-category="social">
                <div class="card-glow"></div>
                <div class="card-header">
                    <i class="fas fa-users card-icon" style="color: #4cc9f0;"></i>
                    <span class="card-badge" style="background: linear-gradient(135deg, #4cc9f0, #7209b7);">SOCIAL</span>
                </div>
                <div class="card-content">
                    <div class="card-title">üë• Comunidad Activa</div>
                    <div class="card-description">1,247 usuarios conectados</div>
                    <div class="card-value">28 Nuevas Tandas ‚Ä¢ 156 Transacciones</div>
                </div>
                <div class="card-action">
                    <div class="card-trend trend-up">
                        <i class="fas fa-heart"></i>
                        <span>En l√≠nea</span>
                    </div>
                    <button class="action-btn" onclick="navigateToSection('marketplace')">Conectar</button>
                </div>
            </div>
        </div>
    </div>

    <script>

        // üîí AUTHENTICATION CHECK - Prevent unauthorized access
        (function() {
            const authToken = localStorage.getItem('auth_token') || sessionStorage.getItem('auth_token');
            if (!authToken) {
                console.warn('‚ö†Ô∏è No authentication token found. Redirecting to login...');
                window.location.href = 'auth-enhanced.html';
                return;
            }
            console.log('‚úÖ Authentication token found. Loading dashboard...');
        })();
// Move togglePreferences to top to avoid reference error from line 1662        function togglePreferences() {            const existingDropdown = document.getElementById("preferencesDropdown");            const toggle = document.getElementById("preferencesToggle");            if (existingDropdown) {                existingDropdown.remove();                toggle.classList.remove("active");                return;            }            const dropdown = document.createElement("div");            dropdown.id = "preferencesDropdown";            dropdown.className = "preferences-dropdown";            dropdown.innerHTML = `Language and preferences coming soon`;            toggle.parentElement.appendChild(dropdown);            toggle.classList.add("active");        }
        // Menu toggle function - Enhanced with error handling
        function toggleMenu() {
            try {
                const sidebar = document.querySelector('.sidebar');
                const overlay = document.querySelector('.sidebar-overlay');
                
                if (!sidebar) {
                    console.warn('Sidebar element not found');
                    return;
                }
                
                sidebar.classList.toggle('active');
                if (overlay) {
                    overlay.classList.toggle('active');
                }
            } catch (error) {
                console.error('Error toggling menu:', error);
            }
        }

        function closeSidebar() {
            try {
                const sidebar = document.querySelector('.sidebar');
                const overlay = document.querySelector('.sidebar-overlay');
                
                if (sidebar) {
                    sidebar.classList.remove('active');
                }
                if (overlay) {
                    overlay.classList.remove('active');
                }
            } catch (error) {
                console.error('Error closing sidebar:', error);
            }
        }

        // üöÄ FUTURISTIC WEB3 FUNCTIONS
        function toggleWalletDetails() {
            alert('üí∞ Wallet Details:\\n\\nüîó Address: 0x1234...5678\\nüíé Balance: 24,567.89 LTD\\nüíµ USD Value: $20,883.71\\n‚ö° Network: La Tanda Chain\\nüîí Status: Connected & Secure');
        }

        function selectTheme(theme) {
            // Store theme preference
            localStorage.setItem('latanda_theme', theme);
            
            // Apply theme changes to UI
            applyThemeChanges(theme);
            
            console.log(`üåì Theme changed to: ${theme}`);
            showNotification(`üåì Tema cambiado a ${theme === 'dark' ? 'oscuro' : 'claro'}`, 'success');
        }

        function selectLanguage(language) {
            // Store language preference
            localStorage.setItem('latanda_language', language);
            
            // Apply language changes
            applyLanguageChanges(language);
            
            const languageNames = {
                'es': 'Espa√±ol',
                'en': 'English', 
                'fr': 'Fran√ßais',
                'de': 'Deutsch',
                'it': 'Italiano',
                'pt': 'Portugu√™s',
                'ru': '–†—É—Å—Å–∫–∏–π',
                'zh': '‰∏≠Êñá',
                'ja': 'Êó•Êú¨Ë™û',
                'ko': 'ÌïúÍµ≠Ïñ¥',
                'ar': 'ÿßŸÑÿπÿ±ÿ®Ÿäÿ©',
                'hi': '‡§π‡§ø‡§®‡•ç‡§¶‡•Ä'
            };
            
            console.log(`üåê Language changed to: ${language}`);
            showNotification(`üåê Idioma cambiado a ${languageNames[language]}`, 'success');
        }

        function selectCurrency(currency) {
            // Store currency preference
            localStorage.setItem('latanda_currency', currency);
            
            // Apply currency changes to UI
            applyCurrencyChanges(currency);
            
            const currencyNames = {
                'USD': 'D√≥lar Americano',
                'HNL': 'Lempira Hondure√±a',
                'LTD': 'La Tanda Token',
                'EUR': 'Euro',
                'GBP': 'Libra Esterlina',
                'JPY': 'Yen Japon√©s',
                'CAD': 'D√≥lar Canadiense',
                'AUD': 'D√≥lar Australiano',
                'CHF': 'Franco Suizo',
                'CNY': 'Yuan Chino',
                'MXN': 'Peso Mexicano',
                'BRL': 'Real Brasile√±o'
            };
            
            console.log(`üí∞ Currency changed to: ${currency}`);
            showNotification(`üí∞ Moneda cambiada a ${currencyNames[currency]}`, 'success');
        }

        function applyThemeChanges(theme) {
            const body = document.body;
            
            if (theme === 'light') {
                // Apply light theme
                body.style.setProperty('--bg-primary', '#f8fafc');
                body.style.setProperty('--bg-secondary', '#e2e8f0');
                body.style.setProperty('--text-primary', '#1e293b');
                body.style.setProperty('--text-secondary', '#64748b');
                body.style.setProperty('--bg-card', 'rgba(255, 255, 255, 0.8)');
            } else {
                // Apply dark theme (default)
                body.style.setProperty('--bg-primary', '#0f172a');
                body.style.setProperty('--bg-secondary', '#1e293b');
                body.style.setProperty('--text-primary', '#f8fafc');
                body.style.setProperty('--text-secondary', 'rgba(248, 250, 252, 0.7)');
                body.style.setProperty('--bg-card', 'rgba(15, 23, 42, 0.6)');
            }
        }

        function togglePreferences() {
            const existingDropdown = document.getElementById('preferencesDropdown');
            const toggle = document.getElementById('preferencesToggle');
            
            // If dropdown exists, remove it
            if (existingDropdown) {
                existingDropdown.remove();
                toggle.classList.remove('active');
                return;
            }
            
            // Create dropdown
            const dropdown = document.createElement('div');
            dropdown.id = 'preferencesDropdown';
            dropdown.className = 'preferences-dropdown';
            
            // Get toggle button position
            const toggleRect = toggle.getBoundingClientRect();
            
            dropdown.style.cssText = `
                position: fixed;
                top: ${toggleRect.bottom + 8}px;
                right: ${window.innerWidth - toggleRect.right}px;
                background: var(--bg-card);
                backdrop-filter: blur(20px);
                border: 1px solid var(--border-accent);
                border-radius: 12px;
                padding: 16px;
                min-width: 220px;
                box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
                z-index: 2000;
                animation: fadeIn 0.3s ease;
                display: block;
            `;
            
            // Get current preferences
            const currentTheme = localStorage.getItem('latanda_theme') || 'dark';
            const currentLanguage = localStorage.getItem('latanda_language') || 'es';
            const currentCurrency = localStorage.getItem('latanda_currency') || 'USD';
            
            dropdown.innerHTML = `
                <div class="preference-group" style="margin-bottom: 16px;">
                    <label style="display: block; color: var(--text-secondary); font-size: 10px; font-weight: 500; margin-bottom: 8px;">
                        <i class="fas fa-palette"></i> Tema
                    </label>
                    <div class="theme-selector" style="
                        background: rgba(0, 0, 0, 0.4);
                        border: 1px solid var(--border-card);
                        border-radius: 8px;
                        padding: 4px;
                        display: flex;
                        gap: 4px;
                    ">
                        <div class="theme-option ${currentTheme === 'dark' ? 'active' : ''}" onclick="selectTheme('dark')" style="
                            padding: 6px 12px;
                            border-radius: 6px;
                            font-size: 11px;
                            font-weight: 600;
                            cursor: pointer;
                            transition: all 0.3s ease;
                            flex: 1;
                            text-align: center;
                            ${currentTheme === 'dark' ? 'background: linear-gradient(135deg, var(--tanda-cyan), var(--tanda-cyan-light)); color: var(--tanda-black);' : 'color: var(--text-secondary);'}
                        ">üåô Oscuro</div>
                        <div class="theme-option ${currentTheme === 'light' ? 'active' : ''}" onclick="selectTheme('light')" style="
                            padding: 6px 12px;
                            border-radius: 6px;
                            font-size: 11px;
                            font-weight: 600;
                            cursor: pointer;
                            transition: all 0.3s ease;
                            flex: 1;
                            text-align: center;
                            ${currentTheme === 'light' ? 'background: linear-gradient(135deg, var(--tanda-cyan), var(--tanda-cyan-light)); color: var(--tanda-black);' : 'color: var(--text-secondary);'}
                        ">‚òÄÔ∏è Claro</div>
                    </div>
                </div>
                
                <div class="preference-group" style="margin-bottom: 16px;">
                    <label style="display: block; color: var(--text-secondary); font-size: 10px; font-weight: 500; margin-bottom: 8px;">
                        <i class="fas fa-globe"></i> Idioma
                    </label>
                    <select class="language-selector" onchange="selectLanguage(this.value)" style="
                        width: 100%;
                        background: rgba(0, 0, 0, 0.4);
                        border: 1px solid var(--border-card);
                        border-radius: 8px;
                        padding: 8px 12px;
                        color: var(--text-primary);
                        font-size: 10px;
                        cursor: pointer;
                        transition: all 0.3s ease;
                    ">
                        <option value="es" ${currentLanguage === 'es' ? 'selected' : ''}>üá™üá∏ Espa√±ol</option>
                        <option value="en" ${currentLanguage === 'en' ? 'selected' : ''}>üá∫üá∏ English</option>
                        <option value="fr" ${currentLanguage === 'fr' ? 'selected' : ''}>üá´üá∑ Fran√ßais</option>
                        <option value="de" ${currentLanguage === 'de' ? 'selected' : ''}>üá©üá™ Deutsch</option>
                        <option value="it" ${currentLanguage === 'it' ? 'selected' : ''}>üáÆüáπ Italiano</option>
                        <option value="pt" ${currentLanguage === 'pt' ? 'selected' : ''}>üáµüáπ Portugu√™s</option>
                        <option value="ru" ${currentLanguage === 'ru' ? 'selected' : ''}>üá∑üá∫ –†—É—Å—Å–∫–∏–π</option>
                        <option value="zh" ${currentLanguage === 'zh' ? 'selected' : ''}>üá®üá≥ ‰∏≠Êñá</option>
                        <option value="ja" ${currentLanguage === 'ja' ? 'selected' : ''}>üáØüáµ Êó•Êú¨Ë™û</option>
                        <option value="ko" ${currentLanguage === 'ko' ? 'selected' : ''}>üá∞üá∑ ÌïúÍµ≠Ïñ¥</option>
                        <option value="ar" ${currentLanguage === 'ar' ? 'selected' : ''}>üá∏üá¶ ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</option>
                        <option value="hi" ${currentLanguage === 'hi' ? 'selected' : ''}>üáÆüá≥ ‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</option>
                    </select>
                </div>
                
                <div class="preference-group" style="margin-bottom: 0;">
                    <label style="display: block; color: var(--text-secondary); font-size: 10px; font-weight: 500; margin-bottom: 8px;">
                        <i class="fas fa-coins"></i> Moneda
                    </label>
                    <select class="currency-selector" onchange="selectCurrency(this.value)" style="
                        width: 100%;
                        background: rgba(0, 0, 0, 0.4);
                        border: 1px solid var(--border-card);
                        border-radius: 8px;
                        padding: 8px 12px;
                        color: var(--text-primary);
                        font-size: 10px;
                        cursor: pointer;
                        transition: all 0.3s ease;
                    ">
                        <option value="USD" ${currentCurrency === 'USD' ? 'selected' : ''}>üíµ USD - D√≥lar Americano</option>
                        <option value="HNL" ${currentCurrency === 'HNL' ? 'selected' : ''}>üá≠üá≥ HNL - Lempira Hondure√±a</option>
                        <option value="LTD" ${currentCurrency === 'LTD' ? 'selected' : ''}>üíé LTD - La Tanda Token</option>
                        <option value="EUR" ${currentCurrency === 'EUR' ? 'selected' : ''}>üí∂ EUR - Euro</option>
                        <option value="GBP" ${currentCurrency === 'GBP' ? 'selected' : ''}>üí∑ GBP - Libra Esterlina</option>
                        <option value="JPY" ${currentCurrency === 'JPY' ? 'selected' : ''}>üí¥ JPY - Yen Japon√©s</option>
                        <option value="CAD" ${currentCurrency === 'CAD' ? 'selected' : ''}>üá®üá¶ CAD - D√≥lar Canadiense</option>
                        <option value="AUD" ${currentCurrency === 'AUD' ? 'selected' : ''}>üá¶üá∫ AUD - D√≥lar Australiano</option>
                        <option value="CHF" ${currentCurrency === 'CHF' ? 'selected' : ''}>üá®üá≠ CHF - Franco Suizo</option>
                        <option value="CNY" ${currentCurrency === 'CNY' ? 'selected' : ''}>üá®üá≥ CNY - Yuan Chino</option>
                        <option value="MXN" ${currentCurrency === 'MXN' ? 'selected' : ''}>üá≤üáΩ MXN - Peso Mexicano</option>
                        <option value="BRL" ${currentCurrency === 'BRL' ? 'selected' : ''}>üáßüá∑ BRL - Real Brasile√±o</option>
                    </select>
                </div>
            `;
            
            // Add to body (not header)
            document.body.appendChild(dropdown);
            toggle.classList.add('active');
        }

        // Close preferences dropdown when clicking outside
        document.addEventListener('click', function(event) {
            const dropdown = document.getElementById('preferencesDropdown');
            const toggle = document.getElementById('preferencesToggle');
            
            if (dropdown && toggle && !toggle.contains(event.target) && !dropdown.contains(event.target)) {
                dropdown.remove();
                toggle.classList.remove('active');
            }
        });

        function applyCurrencyChanges(currency) {
            // Currency exchange rates (mock rates for demo)
            const exchangeRates = {
                'USD': { rate: 0.847, symbol: '$', name: 'USD' },
                'HNL': { rate: 20.85, symbol: 'L', name: 'HNL' }, // Lempira Hondure√±a
                'LTD': { rate: 1, symbol: '≈Å', name: 'LTD' },
                'EUR': { rate: 0.78, symbol: '‚Ç¨', name: 'EUR' },
                'GBP': { rate: 0.67, symbol: '¬£', name: 'GBP' },
                'JPY': { rate: 124.50, symbol: '¬•', name: 'JPY' },
                'CAD': { rate: 1.15, symbol: 'C$', name: 'CAD' },
                'AUD': { rate: 1.28, symbol: 'A$', name: 'AUD' },
                'CHF': { rate: 0.76, symbol: 'Fr', name: 'CHF' },
                'CNY': { rate: 6.18, symbol: '¬•', name: 'CNY' },
                'MXN': { rate: 17.2, symbol: '$', name: 'MXN' },
                'BRL': { rate: 4.35, symbol: 'R$', name: 'BRL' }
            };
            
            const baseLTDAmount = 24567.89; // Base amount in LTD
            const rate = exchangeRates[currency];
            
            if (rate) {
                const convertedAmount = (baseLTDAmount * rate.rate).toFixed(2);
                
                // Update wallet balance display
                const walletBalance = document.querySelector('.wallet-balance');
                if (walletBalance) {
                    if (currency === 'LTD') {
                        walletBalance.textContent = `${convertedAmount} LTD`;
                    } else {
                        walletBalance.textContent = `${rate.symbol}${convertedAmount}`;
                    }
                }
                
                // Update all price displays with data-price attribute - Cached query
                if (!window.cachedPriceElements) {
                    window.cachedPriceElements = document.querySelectorAll('[data-price]');
                }
                window.cachedPriceElements.forEach(element => {
                    const basePrice = parseFloat(element.getAttribute('data-price'));
                    const convertedPrice = (basePrice * rate.rate).toFixed(2);
                    
                    if (currency === 'LTD') {
                        element.textContent = `${convertedPrice} LTD`;
                    } else {
                        element.textContent = `${rate.symbol}${convertedPrice}`;
                    }
                });
                
                // Update cryptocurrency ticker if showing LTD price
                const ltdPriceElements = document.querySelectorAll('.ticker-price');
                ltdPriceElements.forEach((element, index) => {
                    if (index === 0) { // First ticker item is usually LTD
                        const ltdBasePrice = 0.847; // Base LTD price in USD
                        if (currency === 'USD') {
                            element.textContent = `$${ltdBasePrice}`;
                        } else if (currency === 'LTD') {
                            element.textContent = '1.00 LTD';
                        } else {
                            const convertedLTDPrice = (ltdBasePrice * (rate.rate / exchangeRates.USD.rate)).toFixed(4);
                            element.textContent = `${rate.symbol}${convertedLTDPrice}`;
                        }
                    }
                });
            }
        }

        function applyLanguageChanges(lang) {
            const translations = {
                es: {
                    'balance_total': 'Balance Total',
                    'staking_rewards': 'Staking Rewards',
                    'active_tandas': 'Tandas Activas',
                    'ltd_price': 'Precio LTD',
                    'overview': 'Overview Principal',
                    'defi_metrics': 'DeFi Metrics',
                    'governance': 'Governance & Social',
                    'secure': 'Seguro',
                    'notifications': 'Notificaciones'
                },
                en: {
                    'balance_total': 'Total Balance',
                    'staking_rewards': 'Staking Rewards',
                    'active_tandas': 'Active Tandas',
                    'ltd_price': 'LTD Price',
                    'overview': 'Main Overview',
                    'defi_metrics': 'DeFi Metrics',
                    'governance': 'Governance & Social',
                    'secure': 'Secure',
                    'notifications': 'Notifications'
                }
            };

            // Update UI elements with new language - Cached query for performance
            if (!window.cachedTranslateElements) {
                window.cachedTranslateElements = document.querySelectorAll('[data-translate]');
            }
            window.cachedTranslateElements.forEach(element => {
                const key = element.getAttribute('data-translate');
                if (translations[lang] && translations[lang][key]) {
                    element.textContent = translations[lang][key];
                }
            });
        }

        async function openProfileEditor() {
            // Fetch fresh data from API first
            const token = localStorage.getItem('auth_token') || sessionStorage.getItem('auth_token') || '';
            if (token) {
                try {
                    const response = await fetch('https://latanda.online/api/user/profile', {
                        headers: { 'Authorization': 'Bearer ' + token }
                    });
                    const result = await response.json();
                    if (result.success && (result.user || result.data)) {
                        const apiData = result.user || result.data;
                        const existingData = JSON.parse(localStorage.getItem('latanda_user') || '{}');
                        const mergedData = { ...existingData, ...apiData };
                        localStorage.setItem('latanda_user', JSON.stringify(mergedData));
                        console.log('[Profile] Loaded fresh data from API');
                    }
                } catch (err) {
                    console.warn('[Profile] Could not fetch from API, using cached data:', err.message);
                }
            }

            const modal = document.createElement('div');
            modal.className = 'profile-editor-modal';
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.8);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 2000;
                backdrop-filter: blur(8px);
                animation: fadeIn 0.3s ease;
            `;

            // Load current user data (now fresh from API or cached)
            const userData = JSON.parse(localStorage.getItem('latanda_user') || '{}');
            const currentAvatar = userData.avatar || 'https://via.placeholder.com/80/00FFFF/000000?text=U';
            const currentName = userData.name || 'Usuario La Tanda';
            const currentEmail = userData.email || 'usuario@latanda.com';
            const isOnline = userData.isOnline !== false; // Default to online

            modal.innerHTML = `
                <div class="profile-container" style="
                    background: var(--bg-card); 
                    backdrop-filter: blur(20px); 
                    border: 1px solid var(--border-accent);
                    border-radius: 16px; 
                    padding: 24px; 
                    max-width: 380px; 
                    width: 90%; 
                    position: relative;
                    box-shadow: 0 12px 40px rgba(0, 0, 0, 0.4);
                ">
                    <button onclick="this.closest('.profile-editor-modal').remove()" style="
                        position: absolute; 
                        top: 12px; 
                        right: 12px; 
                        background: none; 
                        border: none; 
                        color: var(--text-secondary); 
                        font-size: 20px; 
                        cursor: pointer;
                        padding: 4px;
                        border-radius: 50%;
                        transition: all 0.3s ease;
                    " onmouseover="this.style.background='rgba(255,255,255,0.1)'" onmouseout="this.style.background='none'">√ó</button>
                    
                    <!-- User Profile Section -->
                    <div style="text-align: center; margin-bottom: 20px;">
                        <div style="position: relative; display: inline-block;">
                            <div class="avatar-container" style="
                                width: 80px; 
                                height: 80px; 
                                border-radius: 50%; 
                                margin: 0 auto 12px; 
                                background: url('${currentAvatar}') center/cover;
                                border: 2px solid var(--tanda-cyan);
                                box-shadow: 0 0 15px rgba(0, 255, 255, 0.3);
                                position: relative;
                            " onclick="changeAvatar()"></div>
                            <div class="status-indicator" style="
                                position: absolute;
                                bottom: 8px;
                                right: 8px;
                                width: 16px;
                                height: 16px;
                                border-radius: 50%;
                                background: ${isOnline ? 'var(--success-color)' : '#64748b'};
                                border: 2px solid var(--bg-card);
                                cursor: pointer;
                            " onclick="toggleOnlineStatus()" title="${isOnline ? 'En l√≠nea - Click para cambiar a offline' : 'Offline - Click para cambiar a online'}"></div>
                        </div>
                        
                        <h3 style="color: var(--text-primary); margin: 0 0 4px 0; font-size: 18px;">${currentName}</h3>
                        <p style="color: var(--text-secondary); margin: 0 0 12px 0; font-size: 14px;">${currentEmail}</p>
                        <div style="
                            display: inline-flex; 
                            align-items: center; 
                            gap: 6px; 
                            background: rgba(0, 255, 255, 0.1); 
                            padding: 4px 8px; 
                            border-radius: 12px; 
                            font-size: 12px; 
                            color: var(--tanda-cyan);
                        ">
                            <div style="width: 6px; height: 6px; border-radius: 50%; background: ${isOnline ? 'var(--success-color)' : '#64748b'};"></div>
                            ${isOnline ? 'En l√≠nea' : 'Offline'}
                        </div>
                    </div>
                    
                    <!-- Quick Actions -->
                    <div style="display: grid; gap: 8px; margin-bottom: 16px;">
                        <button onclick="editProfile()" style="
                            background: rgba(0, 255, 255, 0.1); 
                            border: 1px solid var(--border-accent); 
                            color: var(--tanda-cyan); 
                            padding: 10px 16px; 
                            border-radius: 8px; 
                            cursor: pointer; 
                            font-weight: 500;
                            font-size: 14px;
                            transition: all 0.3s ease;
                            display: flex;
                            align-items: center;
                            gap: 8px;
                            justify-content: center;
                        " onmouseover="this.style.background='rgba(0, 255, 255, 0.2)'" onmouseout="this.style.background='rgba(0, 255, 255, 0.1)'">
                            <i class="fas fa-edit"></i> Editar Perfil
                        </button>
                        
                        <button onclick="viewWallet()" style="
                            background: rgba(255, 215, 0, 0.1); 
                            border: 1px solid rgba(255, 215, 0, 0.2); 
                            color: var(--crypto-gold); 
                            padding: 10px 16px; 
                            border-radius: 8px; 
                            cursor: pointer; 
                            font-weight: 500;
                            font-size: 14px;
                            transition: all 0.3s ease;
                            display: flex;
                            align-items: center;
                            gap: 8px;
                            justify-content: center;
                        " onmouseover="this.style.background='rgba(255, 215, 0, 0.2)'" onmouseout="this.style.background='rgba(255, 215, 0, 0.1)'">
                            <i class="fas fa-wallet"></i> Mi Wallet
                        </button>
                        
                        <button onclick="viewSecurity()" style="
                            background: rgba(139, 92, 246, 0.1); 
                            border: 1px solid rgba(139, 92, 246, 0.2); 
                            color: #8b5cf6; 
                            padding: 10px 16px; 
                            border-radius: 8px; 
                            cursor: pointer; 
                            font-weight: 500;
                            font-size: 14px;
                            transition: all 0.3s ease;
                            display: flex;
                            align-items: center;
                            gap: 8px;
                            justify-content: center;
                        " onmouseover="this.style.background='rgba(139, 92, 246, 0.2)'" onmouseout="this.style.background='rgba(139, 92, 246, 0.1)'">
                            <i class="fas fa-shield-alt"></i> Seguridad
                        </button>
                        
                        <button onclick="logout()" style="
                            background: rgba(248, 113, 113, 0.1); 
                            border: 1px solid rgba(248, 113, 113, 0.2); 
                            color: var(--error-color); 
                            padding: 10px 16px; 
                            border-radius: 8px; 
                            cursor: pointer; 
                            font-weight: 500;
                            font-size: 14px;
                            transition: all 0.3s ease;
                            display: flex;
                            align-items: center;
                            gap: 8px;
                            justify-content: center;
                        " onmouseover="this.style.background='rgba(248, 113, 113, 0.2)'" onmouseout="this.style.background='rgba(248, 113, 113, 0.1)'">
                            <i class="fas fa-sign-out-alt"></i> Cerrar Sesi√≥n
                        </button>
                    </div>
                    
                </div>
            `;

            document.body.appendChild(modal);
        }

        function toggleOnlineStatus() {
            const userData = JSON.parse(localStorage.getItem('latanda_user') || '{}');
            userData.isOnline = !userData.isOnline;
            localStorage.setItem('latanda_user', JSON.stringify(userData));
            
            // Close modal and reopen to refresh status
            document.querySelector('.profile-editor-modal').remove();
            openProfileEditor();
            
            showNotification(`Estado cambiado a ${userData.isOnline ? 'En l√≠nea' : 'Offline'}`, 'success');
        }

        function changeAvatar() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const userData = JSON.parse(localStorage.getItem('latanda_user') || '{}');
                        userData.avatar = e.target.result;
                        localStorage.setItem('latanda_user', JSON.stringify(userData));
                        
                        // Refresh the modal
                        document.querySelector('.profile-editor-modal').remove();
                        openProfileEditor();
                        
                        showNotification('‚úÖ Avatar actualizado!', 'success');
                    };
                    reader.readAsDataURL(file);
                }
            };
            input.click();
        }

        function editProfile() {
            // Close current modal and open full edit form
            document.querySelector('.profile-editor-modal').remove();
            openFullProfileEditor();
        }

        function viewWallet() {
            console.log('üõ†Ô∏è Opening wallet...');
            document.querySelector('.profile-editor-modal').remove();
            navigateToSection('wallet');
        }

        function viewSecurity() {
            console.log('üõ°Ô∏è Opening security...');
            document.querySelector('.profile-editor-modal').remove();
            navigateToSection('security');
        }

        function logout() {
            if (confirm('¬øEst√°s seguro que deseas cerrar sesi√≥n?')) {
                // üîê PHASE 1 FIX (Oct 23, 2025): Clear auth token properly
                // Clear user data but keep some settings
                const settings = {
                    language: localStorage.getItem('latanda_language'),
                    theme: localStorage.getItem('latanda_theme')
                };

                // Remove auth data
                localStorage.removeItem('auth_token');
                localStorage.removeItem('latanda_user');
                localStorage.removeItem('latanda_ltd');
                sessionStorage.clear();

                // Restore settings
                if (settings.language) localStorage.setItem('latanda_language', settings.language);
                if (settings.theme) localStorage.setItem('latanda_theme', settings.theme);

                const modal = document.querySelector('.profile-editor-modal');
                if (modal) modal.remove();
                showNotification('üëã Sesi√≥n cerrada exitosamente', 'success');

                // Redirect to auth page after a delay
                setTimeout(() => {
                    window.location.href = 'auth-enhanced.html';
                }, 1500);
            }
        }

        async function openFullProfileEditor() {
            // Fetch fresh data from API first
            const token = localStorage.getItem('auth_token') || sessionStorage.getItem('auth_token') || '';
            if (token) {
                try {
                    const response = await fetch('https://latanda.online/api/user/profile', {
                        headers: { 'Authorization': 'Bearer ' + token }
                    });
                    const result = await response.json();
                    if (result.success && (result.user || result.data)) {
                        // Merge with existing localStorage data
                        const apiData = result.user || result.data;
                        const existingData = JSON.parse(localStorage.getItem('latanda_user') || '{}');
                        const mergedData = { ...existingData, ...apiData };
                        localStorage.setItem('latanda_user', JSON.stringify(mergedData));
                        console.log('[Profile] Loaded fresh data from API');
                    }
                } catch (err) {
                    console.warn('[Profile] Could not fetch from API, using cached data:', err.message);
                }
            }

            const modal = document.createElement('div');
            modal.className = 'full-profile-editor-modal';
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.8);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 2000;
                backdrop-filter: blur(8px);
                animation: fadeIn 0.3s ease;
            `;

            // Load current user data (now fresh from API or cached)
            const userData = JSON.parse(localStorage.getItem('latanda_user') || '{}');
            const currentAvatar = userData.avatar || 'https://via.placeholder.com/120/00FFFF/000000?text=U';
            const currentName = userData.name || 'Usuario La Tanda';
            const currentEmail = userData.email || 'usuario@latanda.com';
            const currentBio = userData.bio || 'Miembro de La Tanda Web3 Protocol';
            const currentPhone = userData.phone || '';
            const currentLocation = userData.location || '';

            modal.innerHTML = `
                <div class="full-profile-container" style="
                    background: var(--bg-card); 
                    backdrop-filter: blur(24px); 
                    border: 2px solid var(--border-accent);
                    border-radius: 20px; 
                    padding: 32px; 
                    max-width: 500px; 
                    width: 90%; 
                    max-height: 90vh;
                    overflow-y: auto;
                    position: relative;
                    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
                ">
                    <button onclick="this.closest('.full-profile-editor-modal').remove()" style="
                        position: absolute; 
                        top: 16px; 
                        right: 16px; 
                        background: none; 
                        border: none; 
                        color: var(--text-secondary); 
                        font-size: 24px; 
                        cursor: pointer;
                        padding: 8px;
                        border-radius: 50%;
                        transition: all 0.3s ease;
                    " onmouseover="this.style.background='rgba(255,255,255,0.1)'" onmouseout="this.style.background='none'">√ó</button>
                    
                    <div style="text-align: center; margin-bottom: 24px;">
                        <div style="
                            background: linear-gradient(135deg, var(--tanda-cyan), var(--tanda-cyan-light)); 
                            width: 60px; 
                            height: 60px; 
                            border-radius: 50%; 
                            display: flex; 
                            align-items: center; 
                            justify-content: center; 
                            margin: 0 auto 16px; 
                            box-shadow: 0 0 20px rgba(0, 255, 255, 0.4);
                        ">
                            <i class="fas fa-user-edit" style="font-size: 24px; color: var(--tanda-black);"></i>
                        </div>
                        <h2 style="color: var(--tanda-cyan); margin-bottom: 8px; font-size: 24px;">Editar Perfil Completo</h2>
                        <p style="color: var(--text-secondary);">Actualiza toda tu informaci√≥n personal</p>
                    </div>
                    
                    <div class="edit-form" style="display: grid; gap: 20px;">
                        <!-- Avatar Section -->
                        <div style="text-align: center;">
                            <div class="avatar-edit-preview" style="
                                width: 100px; 
                                height: 100px; 
                                border-radius: 50%; 
                                margin: 0 auto 12px; 
                                background: url('${currentAvatar}') center/cover;
                                border: 3px solid var(--tanda-cyan);
                                box-shadow: 0 0 15px rgba(0, 255, 255, 0.3);
                                cursor: pointer;
                                position: relative;
                            " onclick="changeAvatarFull()" id="avatarEditPreview">
                                <div style="
                                    position: absolute;
                                    bottom: 0;
                                    right: 0;
                                    background: var(--tanda-cyan);
                                    width: 28px;
                                    height: 28px;
                                    border-radius: 50%;
                                    display: flex;
                                    align-items: center;
                                    justify-content: center;
                                    cursor: pointer;
                                ">
                                    <i class="fas fa-camera" style="font-size: 12px; color: var(--tanda-black);"></i>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Personal Info -->
                        <div class="form-row" style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                            <div class="form-group">
                                <label style="color: var(--text-secondary); display: block; margin-bottom: 6px; font-weight: 500; font-size: 14px;">
                                    <i class="fas fa-user"></i> Nombre Completo
                                </label>
                                <input type="text" id="editProfileName" value="${currentName}" style="
                                    width: 100%; 
                                    padding: 10px 12px; 
                                    background: rgba(0, 0, 0, 0.3); 
                                    border: 1px solid var(--border-card); 
                                    border-radius: 8px; 
                                    color: var(--text-primary); 
                                    font-size: 14px;
                                    transition: all 0.3s ease;
                                " onfocus="this.style.borderColor='var(--tanda-cyan)'" onblur="this.style.borderColor='var(--border-card)'">
                            </div>
                            
                            <div class="form-group">
                                <label style="color: var(--text-secondary); display: block; margin-bottom: 6px; font-weight: 500; font-size: 14px;">
                                    <i class="fas fa-phone"></i> Tel√©fono
                                </label>
                                <input type="tel" id="editProfilePhone" value="${currentPhone}" placeholder="+504 9999-9999" style="
                                    width: 100%; 
                                    padding: 10px 12px; 
                                    background: rgba(0, 0, 0, 0.3); 
                                    border: 1px solid var(--border-card); 
                                    border-radius: 8px; 
                                    color: var(--text-primary); 
                                    font-size: 14px;
                                    transition: all 0.3s ease;
                                " onfocus="this.style.borderColor='var(--tanda-cyan)'" onblur="this.style.borderColor='var(--border-card)'">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label style="color: var(--text-secondary); display: block; margin-bottom: 6px; font-weight: 500; font-size: 14px;">
                                <i class="fas fa-envelope"></i> Email
                            </label>
                            <input type="email" id="editProfileEmail" value="${currentEmail}" style="
                                width: 100%; 
                                padding: 10px 12px; 
                                background: rgba(0, 0, 0, 0.3); 
                                border: 1px solid var(--border-card); 
                                border-radius: 8px; 
                                color: var(--text-primary); 
                                font-size: 14px;
                                transition: all 0.3s ease;
                            " onfocus="this.style.borderColor='var(--tanda-cyan)'" onblur="this.style.borderColor='var(--border-card)'">
                        </div>
                        
                        <div class="form-group">
                            <label style="color: var(--text-secondary); display: block; margin-bottom: 6px; font-weight: 500; font-size: 14px;">
                                <i class="fas fa-map-marker-alt"></i> Ubicaci√≥n
                            </label>
                            <input type="text" id="editProfileLocation" value="${currentLocation}" placeholder="La Tanda Chain Network" style="
                                width: 100%; 
                                padding: 10px 12px; 
                                background: rgba(0, 0, 0, 0.3); 
                                border: 1px solid var(--border-card); 
                                border-radius: 8px; 
                                color: var(--text-primary); 
                                font-size: 14px;
                                transition: all 0.3s ease;
                            " onfocus="this.style.borderColor='var(--tanda-cyan)'" onblur="this.style.borderColor='var(--border-card)'">
                        </div>
                        
                        <div class="form-group">
                            <label style="color: var(--text-secondary); display: block; margin-bottom: 6px; font-weight: 500; font-size: 14px;">
                                <i class="fas fa-info-circle"></i> Biograf√≠a
                            </label>
                            <textarea id="editProfileBio" style="
                                width: 100%; 
                                padding: 10px 12px; 
                                background: rgba(0, 0, 0, 0.3); 
                                border: 1px solid var(--border-card); 
                                border-radius: 8px; 
                                color: var(--text-primary); 
                                font-size: 14px; 
                                resize: vertical; 
                                min-height: 80px;
                                transition: all 0.3s ease;
                            " onfocus="this.style.borderColor='var(--tanda-cyan)'" onblur="this.style.borderColor='var(--border-card)'" placeholder="Cu√©ntanos sobre ti...">${currentBio}</textarea>
                        </div>
                        
                        <!-- Action Buttons -->
                        <div style="display: flex; gap: 12px; justify-content: flex-end; margin-top: 20px;">
                            <button onclick="this.closest('.full-profile-editor-modal').remove()" style="
                                background: transparent; 
                                color: var(--text-secondary); 
                                border: 1px solid var(--border-card); 
                                padding: 10px 20px; 
                                border-radius: 8px; 
                                cursor: pointer; 
                                font-weight: 500;
                                transition: all 0.3s ease;
                            " onmouseover="this.style.borderColor='var(--tanda-cyan)'; this.style.color='var(--tanda-cyan)'" onmouseout="this.style.borderColor='var(--border-card)'; this.style.color='var(--text-secondary)'">
                                Cancelar
                            </button>
                            <button onclick="saveFullProfile()" style="
                                background: linear-gradient(135deg, var(--tanda-cyan), var(--tanda-cyan-light)); 
                                color: var(--tanda-black); 
                                border: none; 
                                padding: 10px 20px; 
                                border-radius: 8px; 
                                cursor: pointer; 
                                font-weight: 600;
                                transition: all 0.3s ease;
                            " onmouseover="this.style.transform='translateY(-1px)'; this.style.boxShadow='0 4px 15px rgba(0, 255, 255, 0.3)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                                <i class="fas fa-save"></i> Guardar Cambios
                            </button>
                        </div>
                    </div>
                </div>
            `;

            document.body.appendChild(modal);
        }

        function changeAvatarFull() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const avatarPreview = document.getElementById('avatarEditPreview');
                        if (avatarPreview) {
                            avatarPreview.style.backgroundImage = `url('${e.target.result}')`;
                            avatarPreview.setAttribute('data-avatar', e.target.result);
                        }
                    };
                    reader.readAsDataURL(file);
                }
            };
            input.click();
        }

        async function saveFullProfile() {
            const name = document.getElementById('editProfileName').value;
            const email = document.getElementById('editProfileEmail').value;
            const phone = document.getElementById('editProfilePhone').value;
            const location = document.getElementById('editProfileLocation').value;
            const bio = document.getElementById('editProfileBio').value;
            const avatarPreview = document.getElementById('avatarEditPreview');
            const avatar = avatarPreview ? (avatarPreview.getAttribute('data-avatar') || avatarPreview.style.backgroundImage.slice(5, -2)) : null;

            // Validate inputs
            if (!name.trim()) {
                showNotification('‚ùå El nombre es requerido', 'error');
                return;
            }

            if (!email.trim() || !email.includes('@')) {
                showNotification('‚ùå Email v√°lido es requerido', 'error');
                return;
            }

            // Prepare user data
            const userData = {
                name: name.trim(),
                email: email.trim(),
                phone: phone.trim(),
                location: location.trim(),
                bio: bio.trim(),
                avatar: avatar,
                lastUpdated: new Date().toISOString(),
                isOnline: true
            };

            // Get auth token
            const token = localStorage.getItem('auth_token') || sessionStorage.getItem('auth_token') || '';

            // Sync with API if token exists
            if (token) {
                try {
                    const response = await fetch('https://latanda.online/api/user/profile', {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': 'Bearer ' + token
                        },
                        body: JSON.stringify({
                            name: userData.name,
                            phone: userData.phone,
                            location: userData.location,
                            bio: userData.bio,
                            avatar_url: userData.avatar
                        })
                    });

                    const result = await response.json();

                    if (!response.ok || !result.success) {
                        console.warn('[Profile] API sync failed:', result.message || 'Unknown error');
                    } else {
                        console.log('[Profile] API sync successful');
                        const apiData = result.user || result.data;
                        if (apiData) {
                            Object.assign(userData, apiData);
                        }
                    }
                } catch (err) {
                    console.warn('[Profile] API sync error:', err.message);
                }
            }

            // Save to localStorage
            localStorage.setItem('latanda_user', JSON.stringify(userData));

            // Update LaTandaUser if available
            if (window.LaTandaUser && window.LaTandaUser.update) {
                window.LaTandaUser.update(userData);
            }

            // Close modal
            document.querySelector('.full-profile-editor-modal').remove();

            // Sync header to reflect changes
            if (window.HeaderSync && window.HeaderSync.syncAll) {
                window.HeaderSync.syncAll();
            }

            // Update header UI directly if available
            if (window.HeaderUI && window.HeaderUI.updateProfile) {
                window.HeaderUI.updateProfile(userData);
            }

            // Show success message
            showNotification('‚úÖ Perfil completo actualizado exitosamente!', 'success');

            console.log('[Profile] Full profile saved:', userData);
        }

        function uploadCustomAvatar() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const avatarPreview = document.getElementById('avatarPreview');
                        if (avatarPreview) {
                            avatarPreview.style.backgroundImage = `url('${e.target.result}')`;
                            // Store the image data for saving
                            avatarPreview.setAttribute('data-avatar', e.target.result);
                        }
                    };
                    reader.readAsDataURL(file);
                }
            };
            input.click();
        }

        function selectNFTAvatar() {
            // Mock NFT selection - in real implementation would connect to NFT collection
            const nftAvatars = [
                'https://via.placeholder.com/120/FF6B6B/FFFFFF?text=NFT1',
                'https://via.placeholder.com/120/4ECDC4/FFFFFF?text=NFT2',
                'https://via.placeholder.com/120/45B7D1/FFFFFF?text=NFT3',
                'https://via.placeholder.com/120/96CEB4/FFFFFF?text=NFT4',
                'https://via.placeholder.com/120/FECA57/FFFFFF?text=NFT5'
            ];
            
            const randomNFT = nftAvatars[Math.floor(Math.random() * nftAvatars.length)];
            const avatarPreview = document.getElementById('avatarPreview');
            if (avatarPreview) {
                avatarPreview.style.backgroundImage = `url('${randomNFT}')`;
                avatarPreview.setAttribute('data-avatar', randomNFT);
            }
            
            // Show NFT selection success message
            showNotification('üé® NFT Avatar seleccionado! (Demo)', 'success');
        }

        function generateAIAvatar() {
            // Mock AI avatar generation - in real implementation would call AI service
            const aiAvatars = [
                'https://via.placeholder.com/120/00FFFF/000000?text=AI1',
                'https://via.placeholder.com/120/FF00FF/FFFFFF?text=AI2',
                'https://via.placeholder.com/120/FFFF00/000000?text=AI3',
                'https://via.placeholder.com/120/00FF00/000000?text=AI4'
            ];
            
            const randomAI = aiAvatars[Math.floor(Math.random() * aiAvatars.length)];
            const avatarPreview = document.getElementById('avatarPreview');
            if (avatarPreview) {
                avatarPreview.style.backgroundImage = `url('${randomAI}')`;
                avatarPreview.setAttribute('data-avatar', randomAI);
            }
            
            // Show AI generation success message
            showNotification('ü§ñ Avatar AI generado! (Demo)', 'success');
        }

        async function saveProfile() {
            const name = document.getElementById('profileName').value;
            const email = document.getElementById('profileEmail').value;
            const bio = document.getElementById('profileBio').value;
            const avatarPreview = document.getElementById('avatarPreview');
            const avatar = avatarPreview ? (avatarPreview.getAttribute('data-avatar') || avatarPreview.style.backgroundImage.slice(5, -2)) : null;

            // Validate inputs
            if (!name.trim()) {
                showNotification('‚ùå El nombre es requerido', 'error');
                return;
            }

            if (!email.trim() || !email.includes('@')) {
                showNotification('‚ùå Email v√°lido es requerido', 'error');
                return;
            }

            // Get existing user data to preserve fields
            const existingData = JSON.parse(localStorage.getItem('latanda_user') || '{}');

            // Prepare user data
            const userData = {
                ...existingData,
                name: name.trim(),
                email: email.trim(),
                bio: bio.trim(),
                avatar: avatar,
                lastUpdated: new Date().toISOString()
            };

            // Get auth token
            const token = localStorage.getItem('auth_token') || sessionStorage.getItem('auth_token') || '';

            // Sync with API if token exists
            if (token) {
                try {
                    const response = await fetch('https://latanda.online/api/user/profile', {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': 'Bearer ' + token
                        },
                        body: JSON.stringify({
                            name: userData.name,
                            bio: userData.bio,
                            avatar_url: userData.avatar
                        })
                    });

                    const result = await response.json();

                    if (!response.ok || !result.success) {
                        console.warn('[Profile] API sync failed:', result.message || 'Unknown error');
                    } else {
                        console.log('[Profile] API sync successful');
                        const apiData = result.user || result.data;
                        if (apiData) {
                            Object.assign(userData, apiData);
                        }
                    }
                } catch (err) {
                    console.warn('[Profile] API sync error:', err.message);
                }
            }

            // Save to localStorage
            localStorage.setItem('latanda_user', JSON.stringify(userData));

            // Update LaTandaUser if available
            if (window.LaTandaUser && window.LaTandaUser.update) {
                window.LaTandaUser.update(userData);
            }

            // Close modal
            document.querySelector('.profile-editor-modal').remove();

            // Sync header to reflect changes
            if (window.HeaderSync && window.HeaderSync.syncAll) {
                window.HeaderSync.syncAll();
            }

            // Update header UI directly if available
            if (window.HeaderUI && window.HeaderUI.updateProfile) {
                window.HeaderUI.updateProfile(userData);
            }

            // Show success message
            showNotification('‚úÖ Perfil actualizado exitosamente!', 'success');

            console.log('[Profile] Profile saved:', userData);
        }

        function showNotification(message, type = 'info') {
            try {
                if (!message) {
                    console.warn('No message provided to showNotification');
                    return;
                }
                
                const notification = document.createElement('div');
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: ${type === 'success' ? 'var(--success-color)' : type === 'error' ? 'var(--error-color)' : 'var(--tanda-cyan)'};
                    color: ${type === 'success' || type === 'error' ? 'white' : 'var(--tanda-black)'};
                    padding: 16px 24px;
                    border-radius: 12px;
                    font-weight: 600;
                    z-index: 3000;
                    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
                    animation: slideInRight 0.3s ease;
                    backdrop-filter: blur(10px);
                `;
                notification.textContent = message;
                
                document.body.appendChild(notification);
            
                
                setTimeout(() => {
                    notification.style.animation = 'slideOutRight 0.3s ease';
                    setTimeout(() => notification.remove(), 300);
                }, 3000);
            } catch (error) {
                console.error('Error showing notification:', error);
            }
        }

        // Auto-update crypto ticker prices
        function updateCryptoTicker() {
            // Cache ticker data to avoid recreating the array every time
            if (!window.cachedCryptoData) {
                window.cachedCryptoData = [
                    { symbol: 'LTD', basePrice: 0.847 },
                    { symbol: 'BTC', basePrice: 43250 },
                    { symbol: 'ETH', basePrice: 2680 },
                    { symbol: 'BNB', basePrice: 312.45 },
                    { symbol: 'MATIC', basePrice: 0.89 },
                    { symbol: 'ADA', basePrice: 0.52 }
                ];
            }
            
            // Cache ticker elements
            if (!window.cachedTickerItems) {
                window.cachedTickerItems = document.querySelectorAll('.ticker-item');
            }
            const tickerItems = window.cachedTickerItems;
            
            tickerItems.forEach((item, index) => {
                if (index < window.cachedCryptoData.length) {
                    const crypto = window.cachedCryptoData[index];
                    const priceElement = item.querySelector('.ticker-price');
                    const changeElement = item.querySelector('.ticker-change');
                    
                    // Simulate price fluctuation
                    const fluctuation = (Math.random() - 0.5) * 0.1; // ¬±5% max
                    const newPrice = crypto.basePrice * (1 + fluctuation);
                    const change = (fluctuation * 100).toFixed(1);
                    
                    // Update price (with null check)
                    if (priceElement) {
                        if (crypto.symbol === 'BTC') {
                            priceElement.textContent = `$${Math.round(newPrice).toLocaleString()}`;
                        } else {
                            priceElement.textContent = `$${newPrice.toFixed(crypto.basePrice < 1 ? 3 : 2)}`;
                        }
                    }

                    // Update change percentage and color (with null check)
                    if (changeElement) {
                        const isPositive = fluctuation > 0;
                        changeElement.textContent = `${isPositive ? '+' : ''}${change}%`;
                        changeElement.className = `ticker-change ${isPositive ? 'ticker-positive' : 'ticker-negative'}`;
                    }
                }
            });
        }

        // Update blockchain status
        function updateBlockchainStatus() {
            const blockElement = document.querySelector('.blockchain-status');
            if (blockElement) {
                const currentBlock = 2847392 + Math.floor(Math.random() * 10);
                const gasPrice = 8 + Math.floor(Math.random() * 20);
                const latency = (1.8 + Math.random() * 2).toFixed(1);
                
                blockElement.innerHTML = `
                    <div class="chain-indicator">
                        <div class="chain-dot"></div>
                        <span>La Tanda Chain</span>
                    </div>
                    <span>Block: ${currentBlock.toLocaleString()}</span>
                    <span>Gas: ${gasPrice} gwei</span>
                    <span>Latency: ${latency}s</span>
                `;
            }
        }

        // Update transaction progress
        function updateTransactionProgress() {
            const txCounter = document.querySelector('.tx-counter');
            const pendingTx = Math.floor(Math.random() * 5);
            if (txCounter) {
                txCounter.textContent = `${pendingTx} Tx`;
            }
        }

        // üé† STATS CAROUSEL FUNCTIONS
        let currentSlide = 0;
        const totalSlides = 3;

        function updateCarousel() {
            const carousel = document.getElementById('statsCarousel');
            const dots = document.querySelectorAll('.carousel-dot');
            
            if (carousel) {
                carousel.style.transform = `translateX(-${currentSlide * 100}%)`;
            }
            
            // Update active dot
            dots.forEach((dot, index) => {
                dot.classList.toggle('active', index === currentSlide);
            });
        }

        function nextSlide() {
            currentSlide = (currentSlide + 1) % totalSlides;
            updateCarousel();
        }

        function previousSlide() {
            currentSlide = (currentSlide - 1 + totalSlides) % totalSlides;
            updateCarousel();
        }

        function goToSlide(slideIndex) {
            currentSlide = slideIndex;
            updateCarousel();
        }

        // Auto-rotate carousel every 15 seconds - Optimized
        function startCarouselAutoPlay() {
            let carouselInterval = setInterval(() => {
                if (!document.hidden) { // Only advance when page is visible
                    nextSlide();
                }
            }, 15000); // Reduced frequency: Change slide every 15 seconds
            
            // Pause carousel when page is hidden
            document.addEventListener('visibilitychange', function() {
                if (document.hidden) {
                    clearInterval(carouselInterval);
                } else {
                    carouselInterval = setInterval(() => {
                        nextSlide();
                    }, 15000);
                }
            });
        }

        // Navigation functions
        function navigateToSection(section) {
            const sectionMap = {
                'wallet': 'my-wallet.html',
                'staking': 'staking.html',
                'groups': 'groups-advanced-system.html',
                'governance': 'governance.html',
                'trading': 'web3-dashboard.html',
                'marketplace': 'marketplace-social.html',
                'profile': 'mi-perfil.html',
                'security': 'seguridad.html',
                'bridge': 'web3-dashboard.html#bridge',
                'transactions': 'transacciones.html',
                'kyc': 'kyc-registration.html',
                'analytics': 'analytics.html',
                'lending': 'lending.html',
                'nft': 'nft-memberships.html',
                'tokenomics': 'ltd-token-economics.html',
                'tvl': 'web3-dashboard.html#tvl',
                'volume': 'web3-dashboard.html#volume',
                'pools': 'web3-dashboard.html#pools',
                'proposals': 'governance.html#proposals',
                'community': 'marketplace-social.html#community',
                'referrals': 'referrals.html'
            };
            
            if (sectionMap[section]) {
                window.location.href = sectionMap[section];
            }
        }

        function showNotifications() {
            try {
                showNotification('üîî Tienes 3 notificaciones nuevas', 'info');
                // Enhanced notification system instead of basic alert
                setTimeout(() => showNotification('üí∞ Tu staking gener√≥ +25 LTD', 'success'), 1000);
                setTimeout(() => showNotification('üë• Nueva tanda premium disponible', 'info'), 2000);
            } catch (error) {
                console.error('Error showing notifications:', error);
                alert('üîî Notificaciones:\n\n‚Ä¢ 3 nuevas propuestas de governance\n‚Ä¢ Tu staking gener√≥ +25 LTD\n‚Ä¢ Nueva tanda premium disponible');
            }
        }

        function showQuickSearch() {
            try {
                const query = prompt('üîç Buscar en La Tanda Universe:');
                if (query && query.trim()) {
                    showNotification(`üîç Buscando: "${query.trim()}"`, 'info');
                    setTimeout(() => showNotification('‚ö° Funcionalidad en desarrollo...', 'warning'), 1500);
                } else if (query === '') {
                    showNotification('‚ùå Por favor ingresa un t√©rmino de b√∫squeda', 'error');
                }
            } catch (error) {
                console.error('Error in quick search:', error);
            }
        }

        // Add slide-in animation to cards with delay
        document.addEventListener('DOMContentLoaded', function() {
            const cards = document.querySelectorAll('.flash-card');
            cards.forEach((card, index) => {
                card.style.animationDelay = `${index * 0.1}s`;
            });
            
            // üöÄ Initialize futuristic Web3 features - Optimized intervals
            updateCryptoTicker(); // Call immediately on page load
            let cryptoTickerInterval = setInterval(updateCryptoTicker, 8000);     // Reduced frequency: Update prices every 8 seconds
            updateBlockchainStatus(); // Call immediately on page load
            let blockchainInterval = setInterval(updateBlockchainStatus, 20000);   // Reduced frequency: Update blockchain every 20 seconds
            updateTransactionProgress(); // Call immediately on page load
            let transactionInterval = setInterval(updateTransactionProgress, 12000); // Reduced frequency: Update transactions every 12 seconds
            
            // Pause intervals when page is not visible to save resources
            document.addEventListener('visibilitychange', function() {
                if (document.hidden) {
                    clearInterval(cryptoTickerInterval);
                    clearInterval(transactionInterval);
                } else {
                    updateCryptoTicker(); // Update immediately when page becomes visible
                    updateBlockchainStatus(); // Update immediately when page becomes visible
                    updateTransactionProgress(); // Update immediately when page becomes visible
                    cryptoTickerInterval = setInterval(updateCryptoTicker, 8000);
                    blockchainInterval = setInterval(updateBlockchainStatus, 20000);
                    transactionInterval = setInterval(updateTransactionProgress, 12000);
                }
            });
            
            // üé† Initialize stats carousel
            startCarouselAutoPlay();
            
            // üéØ Initialize clickeable cards
            // Initialize stat cards hover and click handlers immediately (removed 500ms delay)
                const allStatCards = document.querySelectorAll('.stat-card');
                allStatCards.forEach(card => {
                    card.style.cursor = 'pointer';
                    
                    card.addEventListener('mouseenter', function() {
                        this.style.transform = 'translateY(-8px) scale(1.02)';
                        this.style.borderColor = 'var(--tanda-cyan)';
                        this.style.boxShadow = '0 20px 40px rgba(0, 0, 0, 0.4), 0 0 30px rgba(0, 255, 255, 0.3)';
                    });
                    
                    card.addEventListener('mouseleave', function() {
                        this.style.transform = '';
                        this.style.borderColor = '';
                        this.style.boxShadow = '';
                    });
                });
                
                const statLabels = {
                    'Balance Total': 'wallet',
                    'Staking Rewards': 'staking', 
                    'Tandas Activas': 'groups',
                    'Precio LTD': 'trading',
                    'Total Value Locked': 'tvl',
                    'Trading Volume 24h': 'volume',
                    'Liquidity Pools': 'pools',
                    'Lending Rewards': 'lending',
                    'Propuestas Activas': 'proposals',
                    'NFT Memberships': 'nft',
                    'Comunidad Activa': 'community',
                    'Referidos Totales': 'referrals'
                };
                
                allStatCards.forEach(card => {
                    const label = card.querySelector('.stat-label');
                    if (label && statLabels[label.textContent]) {
                        card.addEventListener('click', function() {
                            const section = statLabels[label.textContent];
                            console.log(`üìä Navigating to: ${section}`);
                            navigateToSection(section);
                        });
                        
                        card.title = `Click para ver ${label.textContent}`;
                    }
                });
            console.log('üöÄ La Tanda Protocol - Futuristic Web3 features activated!');
            console.log('üé† Stats carousel auto-rotation started!');
        });

        // Auto-refresh data simulation - Optimized with page visibility check
        let dataRefreshInterval = setInterval(() => {
            if (document.hidden) return; // Skip updates when page is not visible
            
            const prices = document.querySelectorAll('.card-value');
            prices.forEach(price => {
                if (price.textContent.includes('$')) {
                    // Simulate price updates
                    const currentPrice = parseFloat(price.textContent.match(/\$(\d+\.\d+)/)?.[1] || 0);
                    const change = (Math.random() - 0.5) * 0.1;
                    const newPrice = (currentPrice + change).toFixed(3);
                    price.innerHTML = price.innerHTML.replace(/\$\d+\.\d+/, `$${newPrice}`);
                }
            });
        }, 5000);

        // ================================
        // üöÄ QUICK ACTIONS MODAL FUNCTIONS
        // ================================

        // Function to create and show modal
        function createModal(title, content, width = '500px') {
            const modal = document.createElement('div');
            modal.className = 'latanda-modal';
            modal.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
                background: rgba(0, 0, 0, 0.8); display: flex; align-items: center; 
                justify-content: center; z-index: 10000; backdrop-filter: blur(12px);
                animation: fadeIn 0.3s ease;
            `;
            
            modal.innerHTML = `
                <div class="modal-content" style="background: var(--bg-card); backdrop-filter: blur(24px); 
                           border: 2px solid var(--border-accent); border-radius: 20px; 
                           padding: 32px; max-width: ${width}; width: 90%; position: relative;
                           box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5); animation: slideIn 0.3s ease;">
                    <button onclick="closeModal()" class="modal-close-btn"
                            style="position: absolute; top: 16px; right: 16px; background: none; 
                                   border: none; color: var(--text-secondary); font-size: 28px; 
                                   cursor: pointer; transition: all 0.3s ease; width: 40px; height: 40px;
                                   border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                        <i class="fas fa-times"></i>
                    </button>
                    
                    <div style="text-align: center; margin-bottom: 24px;">
                        <h2 style="color: var(--tanda-cyan); margin-bottom: 8px; font-size: 24px; font-weight: 700;">
                            ${title}
                        </h2>
                    </div>
                    
                    ${content}
                </div>
            `;
            
            // Close modal when clicking outside
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    closeModal();
                }
            });
            
            document.body.appendChild(modal);
            
            // Add animation styles only once
            if (!document.getElementById('modal-animations')) {
                const style = document.createElement('style');
                style.id = 'modal-animations';
                style.textContent = `
                    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
                    @keyframes slideIn { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
                    @keyframes fadeOut { from { opacity: 1; } to { opacity: 0; } }
                    @keyframes slideOut { from { opacity: 1; transform: translateY(0); } to { opacity: 0; transform: translateY(-30px); } }
                `;
                document.head.appendChild(style);
            }
            
            return modal;
        }

        // Function to properly close modal
        function closeModal() {
            const modal = document.querySelector('.latanda-modal');
            if (modal) {
                modal.style.animation = 'fadeOut 0.3s ease';
                const content = modal.querySelector('.modal-content');
                if (content) {
                    content.style.animation = 'slideOut 0.3s ease';
                }
                setTimeout(() => {
                    if (modal && modal.parentNode) {
                        modal.parentNode.removeChild(modal);
                    }
                }, 300);
            }
        }

        // 1. ENVIAR LTD MODAL
        function openSendLTDModal() {
            const content = `
                <form onsubmit="processSendLTD(event)" style="space-y: 20px;">
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; color: var(--text-secondary); font-weight: 600; 
                                     margin-bottom: 8px; font-size: 14px;">
                            <i class="fas fa-link"></i> Seleccionar Chain
                        </label>
                        <select id="chainSelect" required style="width: 100%; background: rgba(0, 0, 0, 0.3); 
                               border: 1px solid var(--border-card); border-radius: 12px; padding: 12px 16px; 
                               color: var(--text-primary); font-size: 14px; transition: all 0.3s ease;">
                            <option value="">Seleccionar blockchain...</option>
                            <option value="latanda">üèõÔ∏è La Tanda Chain</option>
                            <option value="ethereum">üî∑ Ethereum (ETH)</option>
                            <option value="bsc">üü° Binance Smart Chain (BSC)</option>
                            <option value="polygon">üü£ Polygon (MATIC)</option>
                            <option value="arbitrum">üîµ Arbitrum</option>
                            <option value="optimism">üî¥ Optimism</option>
                        </select>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; color: var(--text-secondary); font-weight: 600; 
                                     margin-bottom: 8px; font-size: 14px;">
                            <i class="fas fa-wallet"></i> Direcci√≥n de Destino
                        </label>
                        <input type="text" id="recipientAddress" required placeholder="0x..." 
                               style="width: 100%; background: rgba(0, 0, 0, 0.3); border: 1px solid var(--border-card); 
                                     border-radius: 12px; padding: 12px 16px; color: var(--text-primary); 
                                     font-size: 14px; font-family: monospace;">
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; color: var(--text-secondary); font-weight: 600; 
                                     margin-bottom: 8px; font-size: 14px;">
                            <i class="fas fa-coins"></i> Cantidad LTD
                        </label>
                        <div style="position: relative;">
                            <input type="number" id="sendAmount" required placeholder="0.00" step="0.01" min="0.01"
                                   style="width: 100%; background: rgba(0, 0, 0, 0.3); border: 1px solid var(--border-card); 
                                         border-radius: 12px; padding: 12px 16px; color: var(--text-primary); 
                                         font-size: 14px; padding-right: 80px;">
                            <span style="position: absolute; right: 16px; top: 50%; transform: translateY(-50%); 
                                        color: var(--tanda-cyan); font-weight: 600;">LTD</span>
                        </div>
                        <div style="margin-top: 8px; display: flex; justify-content: space-between; align-items: center;">
                            <span style="color: var(--text-secondary); font-size: 12px;">
                                Balance: <span style="color: var(--tanda-cyan);">15,847.25 LTD</span>
                            </span>
                            <button type="button" onclick="document.getElementById('sendAmount').value = '15847.25'"
                                    style="background: none; border: 1px solid var(--tanda-cyan); color: var(--tanda-cyan); 
                                          padding: 4px 8px; border-radius: 6px; font-size: 11px; cursor: pointer;">
                                MAX
                            </button>
                        </div>
                    </div>
                    
                    <div style="background: rgba(0, 255, 255, 0.1); border: 1px solid var(--border-accent); 
                               border-radius: 12px; padding: 16px; margin-bottom: 24px;">
                        <h4 style="color: var(--tanda-cyan); margin-bottom: 12px; font-size: 14px;">
                            <i class="fas fa-info-circle"></i> Resumen de Transacci√≥n
                        </h4>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: var(--text-secondary);">Cantidad:</span>
                            <span id="summaryAmount" style="color: var(--text-primary);">0.00 LTD</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: var(--text-secondary);">Comisi√≥n de red:</span>
                            <span id="networkFee" style="color: var(--text-primary);">~0.05 LTD</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; border-top: 1px solid var(--border-card); 
                                   padding-top: 8px; margin-top: 8px;">
                            <span style="color: var(--tanda-cyan); font-weight: 600;">Total:</span>
                            <span id="totalAmount" style="color: var(--tanda-cyan); font-weight: 600;">0.05 LTD</span>
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 12px;">
                        <button type="button" onclick="closeModal()" 
                                style="flex: 1; background: transparent; border: 1px solid var(--border-card); 
                                      color: var(--text-secondary); padding: 12px 24px; border-radius: 12px; 
                                      cursor: pointer; font-weight: 600; transition: all 0.3s ease;">
                            Cancelar
                        </button>
                        <button type="submit" 
                                style="flex: 1; background: linear-gradient(135deg, var(--tanda-cyan), var(--tanda-cyan-light)); 
                                      color: var(--tanda-black); border: none; padding: 12px 24px; border-radius: 12px; 
                                      cursor: pointer; font-weight: 600; transition: all 0.3s ease;">
                            <i class="fas fa-paper-plane"></i> Enviar LTD
                        </button>
                    </div>
                </form>
            `;
            
            createModal('<i class="fas fa-paper-plane"></i> Enviar LTD', content, '600px');
            
            // Add real-time calculation
            const amountInput = document.getElementById('sendAmount');
            amountInput.addEventListener('input', updateSendSummary);
        }

        function updateSendSummary() {
            const amount = parseFloat(document.getElementById('sendAmount').value) || 0;
            const fee = 0.05;
            const total = amount + fee;
            
            document.getElementById('summaryAmount').textContent = `${amount.toFixed(2)} LTD`;
            document.getElementById('totalAmount').textContent = `${total.toFixed(2)} LTD`;
        }

        function processSendLTD(event) {
            event.preventDefault();
            const chain = document.getElementById('chainSelect').value;
            const recipient = document.getElementById('recipientAddress').value;
            const amount = document.getElementById('sendAmount').value;
            
            // Show processing animation
            const button = event.target.querySelector('button[type="submit"]');
            button.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Procesando...';
            button.disabled = true;
            
            setTimeout(() => {
                alert(`¬°Transferencia exitosa!\\n\\nChain: ${chain}\\nDestino: ${recipient}\\nCantidad: ${amount} LTD`);
                closeModal();
                // Redirect to wallet module for transaction history
                setTimeout(() => {
                    window.location.href = 'my-wallet.html';
                }, 500);
            }, 2000);
        }

        // 2. CREAR TANDA MODAL
        function openCreateTandaModal() {
            const content = `
                <form onsubmit="processCreateTanda(event)" style="space-y: 20px;">
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; color: var(--text-secondary); font-weight: 600; 
                                     margin-bottom: 8px; font-size: 14px;">
                            <i class="fas fa-tag"></i> Nombre de la Tanda
                        </label>
                        <input type="text" id="tandaName" required placeholder="Ej: Tanda Familia Garc√≠a" 
                               style="width: 100%; background: rgba(0, 0, 0, 0.3); border: 1px solid var(--border-card); 
                                     border-radius: 12px; padding: 12px 16px; color: var(--text-primary); font-size: 14px;">
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 20px;">
                        <div>
                            <label style="display: block; color: var(--text-secondary); font-weight: 600; 
                                         margin-bottom: 8px; font-size: 14px;">
                                <i class="fas fa-users"></i> Participantes
                            </label>
                            <select id="participantCount" required style="width: 100%; background: rgba(0, 0, 0, 0.3); 
                                   border: 1px solid var(--border-card); border-radius: 12px; padding: 12px 16px; 
                                   color: var(--text-primary); font-size: 14px;">
                                <option value="">Seleccionar...</option>
                                <option value="5">5 personas</option>
                                <option value="10">10 personas</option>
                                <option value="15">15 personas</option>
                                <option value="20">20 personas</option>
                                <option value="custom">Personalizado</option>
                            </select>
                        </div>
                        <div>
                            <label style="display: block; color: var(--text-secondary); font-weight: 600; 
                                         margin-bottom: 8px; font-size: 14px;">
                                <i class="fas fa-money-bill"></i> Monto por Cuota
                            </label>
                            <input type="number" id="quotaAmount" required placeholder="1000" step="50" min="100"
                                   style="width: 100%; background: rgba(0, 0, 0, 0.3); border: 1px solid var(--border-card); 
                                         border-radius: 12px; padding: 12px 16px; color: var(--text-primary); font-size: 14px;">
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; color: var(--text-secondary); font-weight: 600; 
                                     margin-bottom: 8px; font-size: 14px;">
                            <i class="fas fa-calendar-alt"></i> Frecuencia de Pago
                        </label>
                        <select id="paymentFrequency" required style="width: 100%; background: rgba(0, 0, 0, 0.3); 
                               border: 1px solid var(--border-card); border-radius: 12px; padding: 12px 16px; 
                               color: var(--text-primary); font-size: 14px;">
                            <option value="">Seleccionar frecuencia...</option>
                            <option value="weekly">Semanal</option>
                            <option value="biweekly">Quincenal</option>
                            <option value="monthly">Mensual</option>
                        </select>
                    </div>
                    
                    <div style="background: rgba(0, 255, 255, 0.1); border: 1px solid var(--border-accent); 
                               border-radius: 12px; padding: 16px; margin-bottom: 24px;">
                        <h4 style="color: var(--tanda-cyan); margin-bottom: 12px; font-size: 14px;">
                            <i class="fas fa-calculator"></i> Resumen de la Tanda
                        </h4>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: var(--text-secondary);">Monto total del pozo:</span>
                            <span id="totalPool" style="color: var(--tanda-cyan); font-weight: 600;">L 0</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: var(--text-secondary);">Duraci√≥n estimada:</span>
                            <span id="estimatedDuration" style="color: var(--text-primary);">-</span>
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 12px;">
                        <button type="button" onclick="closeModal()" 
                                style="flex: 1; background: transparent; border: 1px solid var(--border-card); 
                                      color: var(--text-secondary); padding: 12px 24px; border-radius: 12px; 
                                      cursor: pointer; font-weight: 600;">
                            Cancelar
                        </button>
                        <button type="submit" 
                                style="flex: 1; background: linear-gradient(135deg, var(--tanda-cyan), var(--tanda-cyan-light)); 
                                      color: var(--tanda-black); border: none; padding: 12px 24px; border-radius: 12px; 
                                      cursor: pointer; font-weight: 600;">
                            <i class="fas fa-plus-circle"></i> Crear Tanda
                        </button>
                    </div>
                </form>
            `;
            
            createModal('<i class="fas fa-plus-circle"></i> Crear Nueva Tanda', content, '600px');
            
            // Add real-time calculation
            document.getElementById('participantCount').addEventListener('change', updateTandaSummary);
            document.getElementById('quotaAmount').addEventListener('input', updateTandaSummary);
            document.getElementById('paymentFrequency').addEventListener('change', updateTandaSummary);
        }

        function updateTandaSummary() {
            const participants = parseInt(document.getElementById('participantCount').value) || 0;
            const quota = parseFloat(document.getElementById('quotaAmount').value) || 0;
            const frequency = document.getElementById('paymentFrequency').value;
            
            const totalPool = participants * quota;
            document.getElementById('totalPool').textContent = `L ${totalPool.toLocaleString()}`;
            
            if (frequency && participants > 0) {
                const durations = {
                    weekly: participants + ' semanas',
                    biweekly: (participants * 2) + ' semanas',
                    monthly: participants + ' meses'
                };
                document.getElementById('estimatedDuration').textContent = durations[frequency] || '-';
            }
        }

        function processCreateTanda(event) {
            event.preventDefault();
            const name = document.getElementById('tandaName').value;
            const participants = document.getElementById('participantCount').value;
            const quota = document.getElementById('quotaAmount').value;
            const frequency = document.getElementById('paymentFrequency').value;
            
            const button = event.target.querySelector('button[type="submit"]');
            button.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Creando...';
            button.disabled = true;
            
            setTimeout(() => {
                alert(`¬°Tanda creada exitosamente!\\n\\nNombre: ${name}\\nParticipantes: ${participants}\\nCuota: L ${quota}`);
                closeModal();
                // Redirect to groups module
                setTimeout(() => {
                    window.location.href = 'groups-advanced-system.html';
                }, 500);
            }, 2000);
        }

        // 3. STAKE LTD MODAL
        function openStakeLTDModal() {
            const content = `
                <form onsubmit="processStakeLTD(event)" style="space-y: 20px;">
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; color: var(--text-secondary); font-weight: 600; 
                                     margin-bottom: 8px; font-size: 14px;">
                            <i class="fas fa-coins"></i> Cantidad a Stakear
                        </label>
                        <div style="position: relative;">
                            <input type="number" id="stakeAmount" required placeholder="0.00" step="0.01" min="100"
                                   style="width: 100%; background: rgba(0, 0, 0, 0.3); border: 1px solid var(--border-card); 
                                         border-radius: 12px; padding: 12px 16px; color: var(--text-primary); 
                                         font-size: 14px; padding-right: 80px;">
                            <span style="position: absolute; right: 16px; top: 50%; transform: translateY(-50%); 
                                        color: var(--tanda-cyan); font-weight: 600;">LTD</span>
                        </div>
                        <div style="margin-top: 8px; display: flex; justify-content: space-between; align-items: center;">
                            <span style="color: var(--text-secondary); font-size: 12px;">
                                Balance: <span style="color: var(--tanda-cyan);">15,847.25 LTD</span>
                            </span>
                            <div style="display: flex; gap: 8px;">
                                <button type="button" onclick="setStakeAmount(1000)"
                                        style="background: none; border: 1px solid var(--tanda-cyan); color: var(--tanda-cyan); 
                                              padding: 4px 8px; border-radius: 6px; font-size: 11px; cursor: pointer;">
                                    1K
                                </button>
                                <button type="button" onclick="setStakeAmount(5000)"
                                        style="background: none; border: 1px solid var(--tanda-cyan); color: var(--tanda-cyan); 
                                              padding: 4px 8px; border-radius: 6px; font-size: 11px; cursor: pointer;">
                                    5K
                                </button>
                                <button type="button" onclick="document.getElementById('stakeAmount').value = '15847.25'"
                                        style="background: none; border: 1px solid var(--tanda-cyan); color: var(--tanda-cyan); 
                                              padding: 4px 8px; border-radius: 6px; font-size: 11px; cursor: pointer;">
                                    MAX
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; color: var(--text-secondary); font-weight: 600; 
                                     margin-bottom: 8px; font-size: 14px;">
                            <i class="fas fa-clock"></i> Per√≠odo de Staking
                        </label>
                        <select id="stakePeriod" required style="width: 100%; background: rgba(0, 0, 0, 0.3); 
                               border: 1px solid var(--border-card); border-radius: 12px; padding: 12px 16px; 
                               color: var(--text-primary); font-size: 14px;">
                            <option value="">Seleccionar per√≠odo...</option>
                            <option value="30">30 d√≠as (APR: 12%)</option>
                            <option value="60">60 d√≠as (APR: 18%)</option>
                            <option value="90">90 d√≠as (APR: 25%)</option>
                            <option value="180">180 d√≠as (APR: 35%)</option>
                            <option value="365">365 d√≠as (APR: 50%)</option>
                        </select>
                    </div>
                    
                    <div style="background: rgba(0, 255, 255, 0.1); border: 1px solid var(--border-accent); 
                               border-radius: 12px; padding: 16px; margin-bottom: 24px;">
                        <h4 style="color: var(--tanda-cyan); margin-bottom: 12px; font-size: 14px;">
                            <i class="fas fa-chart-line"></i> Proyecci√≥n de Ganancias
                        </h4>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: var(--text-secondary);">Cantidad a stakear:</span>
                            <span id="stakeAmountSummary" style="color: var(--text-primary);">0 LTD</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: var(--text-secondary);">Recompensas estimadas:</span>
                            <span id="estimatedRewards" style="color: var(--success-color); font-weight: 600;">0 LTD</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; border-top: 1px solid var(--border-card); 
                                   padding-top: 8px; margin-top: 8px;">
                            <span style="color: var(--tanda-cyan); font-weight: 600;">Total al vencimiento:</span>
                            <span id="totalAtMaturity" style="color: var(--tanda-cyan); font-weight: 600;">0 LTD</span>
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 12px;">
                        <button type="button" onclick="closeModal()" 
                                style="flex: 1; background: transparent; border: 1px solid var(--border-card); 
                                      color: var(--text-secondary); padding: 12px 24px; border-radius: 12px; 
                                      cursor: pointer; font-weight: 600;">
                            Cancelar
                        </button>
                        <button type="submit" 
                                style="flex: 1; background: linear-gradient(135deg, var(--success-color), #16a34a); 
                                      color: white; border: none; padding: 12px 24px; border-radius: 12px; 
                                      cursor: pointer; font-weight: 600;">
                            <i class="fas fa-seedling"></i> Iniciar Staking
                        </button>
                    </div>
                </form>
            `;
            
            createModal('<i class="fas fa-seedling"></i> Stake LTD', content, '600px');
            
            document.getElementById('stakeAmount').addEventListener('input', updateStakingSummary);
            document.getElementById('stakePeriod').addEventListener('change', updateStakingSummary);
        }

        function setStakeAmount(amount) {
            document.getElementById('stakeAmount').value = amount;
            updateStakingSummary();
        }

        function updateStakingSummary() {
            const amount = parseFloat(document.getElementById('stakeAmount').value) || 0;
            const period = parseInt(document.getElementById('stakePeriod').value) || 0;
            
            const aprRates = { 30: 0.12, 60: 0.18, 90: 0.25, 180: 0.35, 365: 0.50 };
            const apr = aprRates[period] || 0;
            const dailyRate = apr / 365;
            const rewards = amount * dailyRate * period;
            const total = amount + rewards;
            
            document.getElementById('stakeAmountSummary').textContent = `${amount.toFixed(2)} LTD`;
            document.getElementById('estimatedRewards').textContent = `${rewards.toFixed(2)} LTD`;
            document.getElementById('totalAtMaturity').textContent = `${total.toFixed(2)} LTD`;
        }

        function processStakeLTD(event) {
            event.preventDefault();
            const amount = document.getElementById('stakeAmount').value;
            const period = document.getElementById('stakePeriod').value;
            
            const button = event.target.querySelector('button[type="submit"]');
            button.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Procesando...';
            button.disabled = true;
            
            setTimeout(() => {
                alert(`¬°Staking iniciado exitosamente!\\n\\nCantidad: ${amount} LTD\\nPer√≠odo: ${period} d√≠as`);
                closeModal();
                // Redirect to web3 dashboard for staking management
                setTimeout(() => {
                    window.location.href = 'web3-dashboard.html';
                }, 500);
            }, 2000);
        }

        // 4. TRADING MODAL
        function openTradingModal() {
            const content = `
                <div style="text-align: center;">
                    <i class="fas fa-exchange-alt" style="font-size: 48px; color: var(--tanda-cyan); margin-bottom: 20px;"></i>
                    <h3 style="color: var(--text-primary); margin-bottom: 16px;">Plataforma de Trading</h3>
                    <p style="color: var(--text-secondary); margin-bottom: 24px;">
                        Accede a la plataforma completa de trading para intercambiar criptomonedas.
                    </p>
                    <div style="display: flex; gap: 12px;">
                        <button onclick="closeModal()" 
                                style="flex: 1; background: transparent; border: 1px solid var(--border-card); 
                                      color: var(--text-secondary); padding: 12px 24px; border-radius: 12px; cursor: pointer;">
                            Cancelar
                        </button>
                        <button onclick="closeModal(); setTimeout(() => window.location.href = 'web3-dashboard.html', 300);" 
                                style="flex: 1; background: linear-gradient(135deg, var(--tanda-cyan), var(--tanda-cyan-light)); 
                                      color: var(--tanda-black); border: none; padding: 12px 24px; border-radius: 12px; cursor: pointer;">
                            <i class="fas fa-external-link-alt"></i> Abrir Trading
                        </button>
                    </div>
                </div>
            `;
            createModal('<i class="fas fa-exchange-alt"></i> Trading', content);
        }

        // 5. MARKETPLACE MODAL
        function openMarketplaceModal() {
            const content = `
                <div style="text-align: center;">
                    <i class="fas fa-shopping-bag" style="font-size: 48px; color: var(--tanda-cyan); margin-bottom: 20px;"></i>
                    <h3 style="color: var(--text-primary); margin-bottom: 16px;">Marketplace La Tanda</h3>
                    <p style="color: var(--text-secondary); margin-bottom: 24px;">
                        Explora el marketplace y compra productos usando tus LTD tokens.
                    </p>
                    <div style="display: flex; gap: 12px;">
                        <button onclick="closeModal()" 
                                style="flex: 1; background: transparent; border: 1px solid var(--border-card); 
                                      color: var(--text-secondary); padding: 12px 24px; border-radius: 12px; cursor: pointer;">
                            Cancelar
                        </button>
                        <button onclick="closeModal(); setTimeout(() => window.location.href = 'marketplace-social.html', 300);" 
                                style="flex: 1; background: linear-gradient(135deg, var(--tanda-cyan), var(--tanda-cyan-light)); 
                                      color: var(--tanda-black); border: none; padding: 12px 24px; border-radius: 12px; cursor: pointer;">
                            <i class="fas fa-external-link-alt"></i> Abrir Marketplace
                        </button>
                    </div>
                </div>
            `;
            createModal('<i class="fas fa-shopping-bag"></i> Marketplace', content);
        }

        // 6. GOVERNANCE MODAL
        function openGovernanceModal() {
            const content = `
                <div style="text-align: center;">
                    <i class="fas fa-vote-yea" style="font-size: 48px; color: var(--tanda-cyan); margin-bottom: 20px;"></i>
                    <h3 style="color: var(--text-primary); margin-bottom: 16px;">Governance DAO</h3>
                    <p style="color: var(--text-secondary); margin-bottom: 24px;">
                        Participa en la gobernanza de La Tanda y vota en propuestas importantes.
                    </p>
                    <div style="background: rgba(255, 193, 7, 0.1); border: 1px solid rgba(255, 193, 7, 0.3); 
                               border-radius: 12px; padding: 16px; margin-bottom: 24px;">
                        <div style="color: var(--warning-color); font-size: 14px;">
                            <i class="fas fa-exclamation-triangle"></i> 
                            Necesitas al menos 1,000 LTD stakeados para votar
                        </div>
                    </div>
                    <div style="display: flex; gap: 12px;">
                        <button onclick="closeModal()" 
                                style="flex: 1; background: transparent; border: 1px solid var(--border-card); 
                                      color: var(--text-secondary); padding: 12px 24px; border-radius: 12px; cursor: pointer;">
                            Cancelar
                        </button>
                        <button onclick="closeModal(); setTimeout(() => window.location.href = 'ltd-token-economics.html', 300);" 
                                style="flex: 1; background: linear-gradient(135deg, var(--tanda-cyan), var(--tanda-cyan-light)); 
                                      color: var(--tanda-black); border: none; padding: 12px 24px; border-radius: 12px; cursor: pointer;">
                            <i class="fas fa-external-link-alt"></i> Ver Governance
                        </button>
                    </div>
                </div>
            `;
            createModal('<i class="fas fa-vote-yea"></i> Governance', content);
        }
    </script>

    <script>

        // Handle dynamic content translations for modals
        const originalCreateModal = window.createModal;
        window.createModal = function(title, content) {
            if (originalCreateModal) {
                originalCreateModal(title, content);
            }
            // Retranslate modal content
            if (translationSystem) {
                setTimeout(() => translationSystem.translatePage(), 100);
            }
        };

        // Sidebar Toggle Function (connected to existing hamburger menu)
        function toggleMenu() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('active');
        }

        // Close sidebar when clicking outside
        document.addEventListener('click', function(event) {
            const sidebar = document.getElementById('sidebar');
            const hamburgerMenu = document.querySelector('.hamburger-menu');
            
            if (!sidebar.contains(event.target) && !hamburgerMenu.contains(event.target)) {
                sidebar.classList.remove('active');
            }
        });
    </script>

    <!-- Global Dynamic Footer (shared-components.css + shared-components.js) -->
    <link rel="stylesheet" href="shared-components.css?v=1760032177">
    <script src="shared-components.js"></script>
    <div id="latanda-footer" class="auto-footer"></div>

    
    <script>
        // ================================
        // üìä DYNAMIC ECOSYSTEM METRICS SYSTEM
        // ================================
        
        class LaTandaEcosystemMetrics {
            constructor() {
                this.baseData = {
                    userBalance: 24567.89,
                    stakingRewards: 1847.23,
                    activeTandas: 12,
                    ltdPrice: 0.847,
                    tvl: 847200,
                    tradingVolume: 156800,
                    liquidityPools: 8,
                    lendingRewards: 234.5,
                    activeProposals: 4,
                    nftMemberships: 3,
                    activeCommunity: 1247,
                    totalReferrals: 892
                };
                
                this.init();
            }

            init() {
                this.loadMarketplaceData();
                this.startRealTimeUpdates();
                this.updateAllMetrics();
            }

            // Load data from marketplace and other sections
            loadMarketplaceData() {
                // Get marketplace products and services
                const marketplaceProducts = JSON.parse(localStorage.getItem('latanda_user_products') || '[]');
                const marketplaceServices = JSON.parse(localStorage.getItem('latanda_user_services') || '[]');
                const marketplaceCourses = JSON.parse(localStorage.getItem('latanda_user_courses') || '[]');
                
                // Calculate dynamic metrics based on user activity
                const totalListings = marketplaceProducts.length + marketplaceServices.length + marketplaceCourses.length;
                
                // Update base data with real activity
                this.baseData.activeTandas = Math.max(12, Math.floor(12 + (totalListings * 0.3)));
                this.baseData.userBalance += (totalListings * 25); // Reward for each listing
                
                // Simulate ecosystem growth based on activity
                if (totalListings > 0) {
                    this.baseData.activeCommunity += Math.floor(totalListings * 15);
                    this.baseData.totalReferrals += Math.floor(totalListings * 5);
                }

                console.log('üîÑ Marketplace data loaded:', {
                    products: marketplaceProducts.length,
                    services: marketplaceServices.length,
                    courses: marketplaceCourses.length,
                    totalListings
                });
            }

            // Start real-time metric updates
            startRealTimeUpdates() {
                // Update metrics every 5 seconds with small variations
                setInterval(() => {
                    this.simulateMarketActivity();
                    this.updateAllMetrics();
                }, 5000);

                // Bigger updates every 30 seconds
                setInterval(() => {
                    this.simulateMajorActivity();
                    this.updateAllMetrics();
                }, 30000);
            }

            // Simulate small market fluctuations
            simulateMarketActivity() {
                // Small price fluctuations (¬±2%)
                const priceChange = (Math.random() - 0.5) * 0.02;
                this.baseData.ltdPrice += (this.baseData.ltdPrice * priceChange);
                this.baseData.ltdPrice = Math.max(0.1, this.baseData.ltdPrice); // Min price

                // Trading volume fluctuations
                const volumeChange = (Math.random() - 0.5) * 0.05;
                this.baseData.tradingVolume += (this.baseData.tradingVolume * volumeChange);

                // Staking rewards accumulation
                this.baseData.stakingRewards += Math.random() * 2.5;

                // Community activity
                const communityChange = Math.floor((Math.random() - 0.3) * 10);
                this.baseData.activeCommunity = Math.max(1000, this.baseData.activeCommunity + communityChange);
            }

            // Simulate major ecosystem events
            simulateMajorActivity() {
                // Random events that affect the ecosystem
                const events = [
                    () => {
                        this.baseData.activeTandas += Math.floor(Math.random() * 3);
                        this.showNotification('üéâ Nueva Tanda creada en el ecosistema');
                    },
                    () => {
                        this.baseData.totalReferrals += Math.floor(Math.random() * 15) + 5;
                        this.showNotification('üë• Nuevos usuarios se han unido al ecosistema');
                    },
                    () => {
                        this.baseData.lendingRewards += Math.random() * 50 + 10;
                        this.showNotification('üí∞ Rewards de lending distribuidos');
                    },
                    () => {
                        this.baseData.liquidityPools += Math.random() > 0.7 ? 1 : 0;
                        this.showNotification('üèä Nuevo pool de liquidez agregado');
                    }
                ];

                // Execute random event
                if (Math.random() > 0.6) {
                    const randomEvent = events[Math.floor(Math.random() * events.length)];
                    randomEvent();
                }
            }

            // Update all dashboard metrics
            updateAllMetrics() {
                this.updateMetric('userBalance', this.baseData.userBalance, 'LTD', (this.baseData.userBalance * this.baseData.ltdPrice).toFixed(2) + ' USD');
                this.updateMetric('stakingRewards', this.baseData.stakingRewards, 'LTD', '145% APY Promedio');
                this.updateMetric('activeTandas', this.baseData.activeTandas, '', '3 como coordinador');
                this.updateMetric('ltdPrice', this.baseData.ltdPrice, '$', 'Market Cap: $' + (this.baseData.ltdPrice * 1000000 * 2.83).toLocaleString());
                
                const tvlUsd = (this.baseData.tvl * this.baseData.ltdPrice).toFixed(0);
                this.updateMetric('tvl', (this.baseData.tvl / 1000).toFixed(1) + 'K', 'LTD', '‚âà $' + Number(tvlUsd).toLocaleString() + ' USD');
                
                const volume24h = (this.baseData.tradingVolume / 1000).toFixed(1) + 'K';
                const transactions = Math.floor(this.baseData.tradingVolume / 2000);
                this.updateMetric('tradingVolume', volume24h, 'LTD', transactions + ' transacciones');
                
                this.updateMetric('liquidityPools', this.baseData.liquidityPools, '', '$1.2M liquidez total');
                this.updateMetric('lendingRewards', this.baseData.lendingRewards, 'LTD', '187% APY');
                this.updateMetric('activeProposals', this.baseData.activeProposals, '', '73% participaci√≥n');
                this.updateMetric('nftMemberships', this.baseData.nftMemberships, '', 'Elite, Gold, Silver');
                this.updateMetric('activeCommunity', this.baseData.activeCommunity.toLocaleString(), '', 'usuarios conectados');
                this.updateMetric('totalReferrals', this.baseData.totalReferrals, '', '+45 esta semana');
            }

            // Update specific metric with animation
            updateMetric(id, value, suffix = '', subtitle = '') {
                // Map metric IDs to their label text for fallback search
                const metricLabels = {
                    'userBalance': 'Balance Total',
                    'stakingRewards': 'Staking Rewards', 
                    'activeTandas': 'Tandas Activas',
                    'ltdPrice': 'Precio LTD',
                    'tvl': 'Total Value Locked',
                    'tradingVolume': 'Trading Volume 24h',
                    'liquidityPools': 'Liquidity Pools',
                    'lendingRewards': 'Lending Rewards',
                    'activeProposals': 'Propuestas Activas',
                    'nftMemberships': 'NFT Memberships',
                    'activeCommunity': 'Comunidad Activa',
                    'totalReferrals': 'Referidos Totales'
                };

                // First try to find by data-metric attribute
                let element = document.querySelector(`[data-metric="${id}"]`);
                
                // If not found, search by label text
                if (!element && metricLabels[id]) {
                    const labelText = metricLabels[id];
                    const labels = document.querySelectorAll('.stat-label');
                    for (let label of labels) {
                        if (label.textContent.includes(labelText)) {
                            element = label.parentElement;
                            break;
                        }
                    }
                }
                
                if (element) {
                    const valueElement = element.querySelector('.stat-value');
                    const subtitleElement = element.querySelector('.stat-subtitle');
                    
                    if (valueElement) {
                        // Add animation class
                        valueElement.style.transform = 'scale(1.05)';
                        valueElement.style.color = 'var(--tanda-cyan)';
                        
                        // Update value
                        if (typeof value === 'number') {
                            valueElement.textContent = value.toLocaleString() + ' ' + suffix;
                        } else {
                            valueElement.textContent = value + ' ' + suffix;
                        }
                        
                        // Reset animation
                        setTimeout(() => {
                            valueElement.style.transform = 'scale(1)';
                            valueElement.style.color = '';
                        }, 300);
                    }
                    
                    if (subtitleElement && subtitle) {
                        subtitleElement.textContent = subtitle;
                    }
                } else {
                    console.warn(`‚ùå Metric element not found for: ${id}`);
                }
            }

            // Show ecosystem notifications
            showNotification(message) {
                // Create notification element
                const notification = document.createElement('div');
                notification.className = 'ecosystem-notification';
                notification.innerHTML = `
                    <div class="notification-content">
                        <i class="fas fa-info-circle"></i>
                        <span>${message}</span>
                    </div>
                `;
                
                // Add styles
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: var(--bg-card);
                    backdrop-filter: blur(24px);
                    border: 1px solid var(--tanda-cyan);
                    border-radius: 12px;
                    padding: 16px;
                    color: var(--text-primary);
                    font-size: 14px;
                    z-index: 10000;
                    animation: slideInRight 0.5s ease;
                    box-shadow: 0 8px 32px rgba(0, 255, 255, 0.2);
                `;
                
                document.body.appendChild(notification);
                
                // Remove after 4 seconds
                setTimeout(() => {
                    notification.style.animation = 'slideOutRight 0.5s ease';
                    setTimeout(() => {
                        if (notification.parentNode) {
                            notification.parentNode.removeChild(notification);
                        }
                    }, 500);
                }, 4000);

                console.log('üì¢ Ecosystem notification:', message);
            }

            // Get current ecosystem status
            getEcosystemStatus() {
                return {
                    totalValue: this.baseData.userBalance * this.baseData.ltdPrice,
                    ecosystemGrowth: ((this.baseData.activeCommunity - 1247) / 1247 * 100).toFixed(1) + '%',
                    marketHealth: this.baseData.ltdPrice > 0.8 ? 'Excellent' : this.baseData.ltdPrice > 0.6 ? 'Good' : 'Moderate',
                    activity: this.baseData.activeTandas + this.baseData.activeProposals,
                    ...this.baseData
                };
            }
        }

        // CSS for animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInRight {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOutRight {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
            .notification-content {
                display: flex;
                align-items: center;
                gap: 8px;
            }
            .notification-content i {
                color: var(--tanda-cyan);
            }
        `;
        document.head.appendChild(style);

        // Initialize the metrics system when page loads
        let ecosystemMetrics;
        
        // Footer Real-time Updates
        function updateFooterData() {
            try {
                // Update footer LTD price
                const footerPrice = document.getElementById('footerLTDPrice');
                const footerPriceChange = document.getElementById('footerPriceChange');
                if (footerPrice && footerPriceChange) {
                    const basePrice = 0.847;
                    const variation = (Math.random() - 0.5) * 0.02;
                    const newPrice = basePrice + variation;
                    const changePercent = ((newPrice - basePrice) / basePrice * 100);
                    
                    footerPrice.textContent = newPrice.toFixed(3);
                    footerPriceChange.textContent = `${changePercent >= 0 ? '+' : ''}${changePercent.toFixed(1)}%`;
                    footerPriceChange.className = `price-change ${changePercent >= 0 ? 'positive' : 'negative'}`;
                }
                
                // Update footer stats
                const footerTVL = document.getElementById('footerTVL');
                const footerUsers = document.getElementById('footerUsers');
                if (footerTVL) {
                    const baseTVL = 2.8;
                    const tvlVariation = (Math.random() - 0.5) * 0.1;
                    footerTVL.textContent = `$${(baseTVL + tvlVariation).toFixed(1)}M`;
                }
                if (footerUsers) {
                    const baseUsers = 1247;
                    const userVariation = Math.floor((Math.random() - 0.5) * 20);
                    footerUsers.textContent = (baseUsers + userVariation).toLocaleString();
                }
                
                // Update network status
                const currentBlock = document.getElementById('currentBlock');
                const networkStatus = document.getElementById('networkStatus');
                const networkDot = document.getElementById('networkDot');
                if (currentBlock) {
                    const baseBlock = 2847392;
                    const blockIncrement = Math.floor(Math.random() * 3);
                    currentBlock.textContent = (baseBlock + blockIncrement).toLocaleString();
                }
                
                // Simulate occasional network status changes
                if (Math.random() < 0.1 && networkStatus && networkDot) {
                    const statuses = [
                        { text: 'Mainnet Online', class: 'active' },
                        { text: 'High Traffic', class: 'warning' },
                        { text: 'Syncing...', class: 'syncing' }
                    ];
                    const randomStatus = statuses[Math.floor(Math.random() * statuses.length)];
                    networkStatus.textContent = randomStatus.text;
                    networkDot.className = `status-dot ${randomStatus.class}`;
                    
                    // Reset to normal after a few seconds
                    setTimeout(() => {
                        networkStatus.textContent = 'Mainnet Online';
                        networkDot.className = 'status-dot active';
                    }, 5000);
                }
            } catch (error) {
                console.error('Error updating footer data:', error);
            }
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize immediately (removed 1-second delay for better UX)
            ecosystemMetrics = new LaTandaEcosystemMetrics();
            
            // Initialize footer updates
            updateFooterData();
            setInterval(updateFooterData, 12000); // Update every 12 seconds
            
            // Make it globally available
            window.LaTandaEcosystem = ecosystemMetrics;
            console.log('üöÄ La Tanda Ecosystem Metrics System initialized');
            
        });
    </script>

    <!-- üåê Translation System -->
    <script src="https://cdn.jsdelivr.net/npm/i18next@23.7.11/i18next.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/i18next-http-backend@2.4.2/i18nextHttpBackend.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/i18next-browser-languagedetector@7.2.0/i18nextBrowserLanguageDetector.min.js"></script>
    <script src="i18next-implementation-backend.js?v=1759688935"></script>
    
    <!-- üöÄ Real-time API Integration -->
    <script src="real-time-api-integration.js"></script>
    
    <!-- üîß Dashboard Integration Fix -->
    <script src="dashboard-integration-fix.js"></script>
    
    <!-- Notification Center Component -->
    <script src="js/components/notification-center.js"></script>
    <!-- Wallet Dropdown Component -->
    <!-- Network Switcher Component -->
    <script src="js/components/network-switcher.js"></script>
    <!-- Mobile Wallet Connection Fix -->

<script>
// Wallet Balance Visibility Toggle
function toggleBalanceVisibility() {    const balanceEl = document.querySelector(".wallet-balance");    const eyeIcon = document.getElementById("walletEyeIcon");    const isHidden = balanceEl.classList.toggle("hidden");        if (isHidden) {        eyeIcon.classList.remove("fa-eye");        eyeIcon.classList.add("fa-eye-slash");    } else {        eyeIcon.classList.remove("fa-eye-slash");        eyeIcon.classList.add("fa-eye");    }        localStorage.setItem("walletBalanceHidden", isHidden);}

document.addEventListener("DOMContentLoaded", () => {    const isHidden = localStorage.getItem("walletBalanceHidden") === "true";    if (isHidden) {        const balanceEl = document.querySelector(".wallet-balance");        const eyeIcon = document.getElementById("walletEyeIcon");        if (balanceEl && eyeIcon) {            balanceEl.classList.add("hidden");            eyeIcon.classList.remove("fa-eye");            eyeIcon.classList.add("fa-eye-slash");        }    }});</script>
    <!-- Transaction Modal Component -->
    <script src="js/components/transaction-modal.js"></script>
    <!-- üîå Real Data API Connector -->
    <script src="js/dashboard-api-connector.js"></script>
    <!-- üìä Real Data Patch -->
    <script src="js/dashboard-real-data-patch.js"></script>
    <script src="js/dashboard-sections-loader.js"></script>
    <!-- üßπ Header/Footer Cleanup -->
    <script src="js/header-footer-cleanup.js"></script>
    <!-- Loading States Component -->
    <script src="js/components/loading-states.js"></script>
    <!-- Global Header Scripts -->
    <script src="js/components-loader.js?v=2.7"></script>

    <!-- Header Sync Manager with JWT - v1.3 -->
    <script>
    /**
     * LA TANDA - Header Sync Manager
     * Real-time data synchronization with polling
     * @version 1.3 - Added JWT authentication
     */
    const HeaderSync = {
        intervals: {},
        isVisible: true,
        lastSync: null,
        pausedAt: null,

        config: {
            balanceInterval: 30000,
            notifInterval: 60000,
            pauseThreshold: 30000
        },

        getAuthToken() {
            return localStorage.getItem("auth_token") || sessionStorage.getItem("auth_token") || null;
        },

        getAuthHeaders() {
            const token = this.getAuthToken();
            return token ? { "Authorization": "Bearer " + token } : {};
        },

        getUserId() {
            if (window.LaTandaUser && window.LaTandaUser.getId) {
                const id = window.LaTandaUser.getId();
                if (id) return id;
            }
            try {
                const userData = localStorage.getItem("latanda_user");
                if (userData) {
                    const user = JSON.parse(userData);
                    if (user.id) return user.id;
                }
            } catch (e) {}
            return localStorage.getItem("user_id") || null;
        },

        start() {
            document.addEventListener("visibilitychange", () => {
                this.handleVisibilityChange();
            });

            this.intervals.balance = setInterval(() => {
                if (this.isVisible) this.syncBalance();
            }, this.config.balanceInterval);

            this.intervals.notifications = setInterval(() => {
                if (this.isVisible) this.syncNotifications();
            }, this.config.notifInterval);

            this.syncAll();
            console.log("[HeaderSync] Started v1.3 with JWT");
        },

        stop() {
            Object.values(this.intervals).forEach(clearInterval);
            this.intervals = {};
        },

        handleVisibilityChange() {
            if (document.hidden) {
                this.isVisible = false;
                this.pausedAt = Date.now();
            } else {
                this.isVisible = true;
                if (this.pausedAt && Date.now() - this.pausedAt > this.config.pauseThreshold) {
                    this.syncAll();
                }
                this.pausedAt = null;
            }
        },

        async syncAll() {
            await Promise.all([
                this.syncBalance(),
                this.syncNotifications()
            ]);
            this.lastSync = Date.now();
        },

        async syncBalance() {
            const userId = this.getUserId();
            if (!userId) return null;

            try {
                const url = "https://latanda.online/api/wallet/balance?user_id=" + userId;
                const response = await fetch(url, { headers: this.getAuthHeaders() });
                const data = await response.json();

                if (data.success) {
                    const balance = {
                        amount: parseFloat(data.data?.balance || data.data?.confirmed_balance || data.balance || 0),
                        pending: parseFloat(data.data?.pending_deposits || data.pending || 0),
                        currency: "HNL"
                    };
                    if (window.HeaderUI && window.HeaderUI.updateBalance) {
                        window.HeaderUI.updateBalance(balance);
                    }
                    return balance;
                }
            } catch (err) {
                console.warn("[HeaderSync] Balance sync failed:", err.message);
            }
            return null;
        },

        async syncNotifications() {
            const userId = this.getUserId();
            if (!userId) return null;

            try {
                const url = "https://latanda.online/api/notifications?user_id=" + userId + "&status=unread";
                const response = await fetch(url, { headers: this.getAuthHeaders() });
                const data = await response.json();

                if (data.success) {
                    const notifs = {
                        count: (data.data?.length || data.notifications?.length || 0),
                        items: data.data || data.notifications || []
                    };
                    if (window.HeaderUI && window.HeaderUI.updateNotifCount) {
                        window.HeaderUI.updateNotifCount(notifs.count);
                    }
                    return notifs;
                }
            } catch (err) {
                console.warn("[HeaderSync] Notifications sync failed:", err.message);
            }
            return null;
        },

        forceRefresh(type) {
            if (type === "balance") return this.syncBalance();
            if (type === "notifications") return this.syncNotifications();
            if (type === "all") return this.syncAll();
        }
    };

    window.HeaderSync = HeaderSync;

    // Auto-start when DOM is ready
    if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", () => HeaderSync.start());
    } else {
        HeaderSync.start();
    }
    </script>
</body>
</html>